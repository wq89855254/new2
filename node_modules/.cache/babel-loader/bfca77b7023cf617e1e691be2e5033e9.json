{"remainingRequest":"D:\\program\\frontend\\node_modules\\babel-loader\\lib\\index.js!D:\\program\\frontend\\src\\assets\\js\\leaflet-rh.js","dependencies":[{"path":"D:\\program\\frontend\\src\\assets\\js\\leaflet-rh.js","mtime":1553855601685},{"path":"D:\\program\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\program\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _parseFloat from \"D:\\\\program\\\\frontend\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/parse-float\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.sort\";\nimport \"core-js/modules/es6.array.fill\";\nimport zrender from 'zrender';\n/**\r\n * zrender shape extend: WindVane\r\n */\n\nzrender['WindVane'] = zrender.Path.extend({\n  type: 'windVane',\n  shape: {\n    x: 0,\n    y: 0,\n    speed: 0,\n    width: 8,\n    height: 25\n  },\n  buildPath: function buildPath(ctx, shape) {\n    var x = shape.x;\n    var y = shape.y;\n    var width = shape.width;\n    var height = shape.height;\n    var speed = shape.speed;\n    var dir = shape.dir;\n\n    if (speed != null && speed > 0) {\n      ctx.moveTo(x, y);\n      ctx.lineTo(x, y - height);\n      var wholeLines = Math.floor(speed / 4);\n      var halfLine = speed % 4 > 0;\n      var carriage = height;\n      var interval = width / 2;\n      var _wholeLines = wholeLines;\n      var xShift = width;\n      var yShift = xShift * Math.tan(30 * Math.PI / 180);\n\n      for (var i = 0; i < wholeLines; i++) {\n        ctx.moveTo(x, y - carriage);\n\n        if (_wholeLines >= 5) {\n          ctx.lineTo(x + xShift, y - carriage);\n          ctx.lineTo(x, y - carriage + yShift);\n          ctx.fill();\n          i += 4;\n          _wholeLines -= 5;\n          carriage -= yShift;\n        } else {\n          ctx.lineTo(x + xShift, y - carriage - yShift);\n          carriage -= interval;\n        }\n      }\n\n      if (halfLine) {\n        if (wholeLines == 0) carriage -= interval;\n        ctx.moveTo(x, y - carriage);\n        ctx.lineTo(x + xShift / 2 + 1, y - carriage - yShift / 2);\n      }\n\n      ctx.stroke();\n    }\n  }\n});\n/**\r\n * Leaflet RiHang Extentions\r\n */\n\nL.RH = {\n  Util: {\n    getWindSpeedAndDegree: function getWindSpeedAndDegree(u, v) {\n      var speed = Math.sqrt(u * u + v * v);\n      var dir = 0;\n\n      if (u == 0) {\n        dir = v < 0 ? 0 : 180;\n      } else {\n        dir = Math.atan(v / u) / Math.PI * 180;\n        dir = u > 0 ? 270 - dir : 90 - dir;\n      }\n\n      return {\n        speed: speed,\n        dir: dir\n      };\n    },\n    isNationalStationId: function isNationalStationId(stationId) {\n      if (!stationId) {\n        return false;\n      }\n\n      if (stationId.length === 6) {\n        return true;\n      }\n\n      if (stationId.charAt(0) >= 'A' && stationId.charAt(0) <= 'Z') {\n        return true;\n      }\n\n      return false;\n    },\n    graddingStationDataWithZoom: function graddingStationDataWithZoom(datas, map, options) {\n      var defaultOptions = {\n        cellSize: 60,\n        includeShowAnyway: true\n      };\n\n      for (var key in options) {\n        defaultOptions[key] = options[key];\n      }\n\n      var sortedDatas = datas.sort(function compareNumbers(a, b) {\n        if (a.showAnyway === true && b.showAnyway === true) {\n          return 0;\n        } else if (a.showAnyway === true) {\n          return 1;\n        } else if (b.showAnyway === true) {\n          return -1;\n        } else {\n          if (L.RH.Util.isNationalStationId(a.stationId) && L.RH.Util.isNationalStationId(b.stationId)) {\n            return 0;\n          } else if (L.RH.Util.isNationalStationId(a.stationId)) {\n            return 1;\n          } else if (L.RH.Util.isNationalStationId(b.stationId)) {\n            return -1;\n          }\n\n          return 0;\n        }\n      });\n      var ret = [];\n      var existBounds = [];\n      sortedDatas.forEach(function (element) {\n        var pixelPoint = map.latLngToContainerPoint([element.lat, element.lng]);\n        var eleBound = L.bounds(L.point(pixelPoint.x - defaultOptions.cellSize / 2, pixelPoint.y - defaultOptions.cellSize / 2), L.point(pixelPoint.x + defaultOptions.cellSize / 2, pixelPoint.y + defaultOptions.cellSize / 2));\n\n        if (element.showAnyway) {\n          ret.push(element);\n\n          if (defaultOptions.includeShowAnyway) {\n            existBounds.push(eleBound);\n          }\n        } else {\n          var intersects = false;\n\n          for (var i = 0; i < existBounds.length; i++) {\n            var oneBound = existBounds[i];\n\n            if (oneBound.intersects(eleBound)) {\n              intersects = true;\n              return;\n            }\n          }\n\n          if (!intersects) {\n            ret.push(element);\n            existBounds.push(eleBound);\n          }\n        }\n      });\n      return ret;\n    }\n  }\n};\nL.RH.NoTranslateCanvas = L.Canvas.extend({\n  options: {\n    padding: 0,\n    interactive: true\n  },\n  _initContainer: function _initContainer() {\n    L.Canvas.prototype._initContainer.call(this);\n\n    if (!this.options.interactive) this._container.style.pointerEvents = 'none';\n  },\n  _update: function _update() {\n    if (this._map._animatingZoom && this._bounds) {\n      return;\n    }\n\n    this._drawnLayers = {};\n\n    L.Renderer.prototype._update.call(this);\n\n    var b = this._bounds,\n        container = this._container,\n        size = b.getSize(),\n        // m = L.Browser.retina ? 2 : 1;\n    m = 1; // modified by helen in 2016/9/30\n\n    L.DomUtil.setPosition(container, b.min); // set canvas size (also clearing it); use double size on retina\n\n    container.width = m * size.x;\n    container.height = m * size.y;\n    container.style.width = size.x + 'px';\n    container.style.height = size.y + 'px'; //if (L.Browser.retina) {\n    //    this._ctx.scale(2, 2);\n    //    this._ctx.translate(-b.min.x, -b.min.y);\n    //}\n    // translate so we use the same path coordinates after canvas element moves\n    //this._ctx.translate(-b.min.x, -b.min.y);\n    // Tell paths to redraw themselves\n    // this.fire('update');\n  }\n});\n\nL.RH.noTranslateCanvas = function (options) {\n  return L.Browser.canvas ? new L.RH.NoTranslateCanvas(options) : null;\n};\n\nL.RH.ZrCanvas = L.RH.NoTranslateCanvas.extend({\n  initialize: function initialize(options) {\n    L.RH.NoTranslateCanvas.prototype.initialize.call(this, options);\n\n    this._initZr();\n  },\n  onAdd: function onAdd() {\n    this._initZr();\n\n    this.getPane().appendChild(this._container);\n\n    this._update();\n  },\n  _initZr: function _initZr() {\n    if (!this._container) {\n      this._initContainer(); // defined by renderer implementations\n      // if (this._zoomAnimated) {\n      //   L.DomUtil.addClass(this._container, 'leaflet-zoom-animated');\n      // }\n\n\n      L.DomUtil.addClass(this._container, 'leaflet-zoom-hide');\n    }\n\n    if (this._container) {\n      this.zr = zrender.init(this._container);\n    }\n  }\n});\n\nL.RH.zrCanvas = function (options) {\n  return L.Browser.canvas ? new L.RH.ZrCanvas(options) : null;\n};\n\nL.RH.CanvasLayer = L.Path.extend({\n  options: {\n    renderer: L.RH.noTranslateCanvas()\n  },\n  getEvents: function getEvents() {\n    return {\n      zoomend: this._zoomend,\n      moveend: this._update\n    };\n  },\n  beforeAdd: function beforeAdd(map) {\n    this._map = map;\n    L.Path.prototype.beforeAdd.call(this, map);\n  },\n  onAdd: function onAdd() {\n    this._renderer = this._map.getRenderer(this);\n\n    this._update();\n  },\n  onRemove: function onRemove() {\n    if (this._map.hasLayer(this._renderer)) this._map.removeLayer(this._renderer);\n  },\n  _zoomend: function _zoomend() {},\n  _update: L.Util.falseFn(),\n  clear: function clear() {\n    var size = this.size = this._renderer._bounds.getSize();\n\n    this._renderer._ctx.clearRect(0, 0, size.x, size.y);\n  }\n});\nL.RH.ZrBaseLayer = L.RH.CanvasLayer.extend({\n  options: {\n    renderer: null\n  },\n  initialize: function initialize(options) {\n    L.setOptions(this, options);\n\n    if (!this.options.render) {\n      this.options.renderer = L.RH.zrCanvas({\n        pane: 'overlayPane'\n      });\n    }\n  },\n  onRemove: function onRemove() {\n    this.clear();\n    this.rootGroup.removeAll();\n\n    this._renderer.zr.dispose();\n  },\n  _update: function _update() {\n    if (!this.rootGroup) {\n      this.rootGroup = new zrender.Group();\n\n      this._renderer.zr.add(this.rootGroup);\n    } else {\n      this.rootGroup.removeAll();\n    }\n\n    this.rhUpdate(this.rootGroup);\n  },\n  // Your logic should be here\n  rhUpdate: function rhUpdate(rootGroup) {}\n});\n\nL.RH.zrBaseLayer = function (options) {\n  return new L.RH.ZrBaseLayer(options);\n};\n/**\r\n * \r\n * 使用该功能组件时要遵循的数据格式\r\n * \r\n  datas = [{\r\n          stationId: 54511,\r\n          stationName: '气象台',\r\n          lng: 75.77 ,\r\n          lat: 37.98,\r\n          datas: [1, null, 1, null],\r\n          datasVisibilityMask: [true, false, true, false]  //控制要素的显示，与datas一一对应\r\n          showAnyway:true  //true表示显示全部|false表示抽稀\r\n          wind: [u, v],\r\n          stationImageUrl: Math.random() < 0.3 ? './assets/img/ico.png' : null\r\n        }]\r\n */\n\n\nL.RH.ZdzLayer = L.RH.ZrBaseLayer.extend({\n  // 配置参数\n  options: {\n    xOffset: 5,\n    yOffset: 5,\n    showStationName: true,\n    showWind: true,\n    stationNameColor: 'black',\n    datasVisibilityMask: [true, true, true, true, true],\n    datasColor: ['#A52A2A', '#0000A0', '#008000', 'black', '#f0f'],\n    //与datasVisibilityMask一一对应\n    graddingOptions: {\n      cellSize: 60,\n      includeShowAnyway: true\n    },\n    centerPointColor: 'red',\n    //当数据中没有stationImageUrl字段或为null时，设置中心圆的颜色\n    clickHandler: function clickHandler(element) {}\n  },\n  getOptions: function getOptions() {\n    return this.options;\n  },\n  setData: function setData(datas) {\n    this.datas = datas;\n    this._zoomMapDatas = {};\n    this.datas.forEach(function (element) {\n      if (element.wind) {\n        element.windSD = L.RH.Util.getWindSpeedAndDegree(element.wind[0], element.wind[1]);\n      }\n    }, this);\n\n    if (this.rootGroup) {\n      this._update(this.rootGroup);\n    }\n  },\n  addData: function addData(items) {\n    this.datas = this.datas || [];\n    this._zoomMapDatas = {};\n\n    var bounds = this._map.getBounds();\n\n    var pixelBounds = L.bounds(this._map.latLngToContainerPoint(bounds.getNorthWest()), this._map.latLngToContainerPoint(bounds.getSouthEast()));\n    items.forEach(function (element) {\n      if (element.wind) {\n        element.windSD = L.RH.Util.getWindSpeedAndDegree(element.wind[0], element.wind[1]);\n      }\n\n      this.datas.push(element);\n      var from = L.latLng(element.lat, element.lng);\n\n      var fromPixel = this._map.latLngToContainerPoint(from);\n\n      if (pixelBounds.contains(fromPixel)) {\n        this.drawOne(this.rootGroup, element, fromPixel);\n      }\n    }, this);\n  },\n  getData: function getData() {\n    return this.datas;\n  },\n  refresh: function refresh() {\n    this._zoomMapDatas = {};\n\n    if (this.rootGroup) {\n      this._update(this.rootGroup);\n    }\n  },\n  rhUpdate: function rhUpdate(rootGroup) {\n    if (!this.datas) {\n      return;\n    }\n\n    var filteredDatas = this._zoomMapDatas[this._map.getZoom()];\n\n    if (!filteredDatas) {\n      filteredDatas = L.RH.Util.graddingStationDataWithZoom(this.datas, this._map, this.options.graddingOptions);\n      this._zoomMapDatas[this._map.getZoom()] = filteredDatas;\n    }\n\n    var bounds = this._map.getBounds();\n\n    var pixelBounds = L.bounds(this._map.latLngToContainerPoint(bounds.getNorthWest()), this._map.latLngToContainerPoint(bounds.getSouthEast()));\n    filteredDatas.forEach(function (element) {\n      var from = L.latLng(element.lat, element.lng);\n\n      var fromPixel = this._map.latLngToContainerPoint(from);\n\n      if (pixelBounds.contains(fromPixel)) {\n        this.drawOne(rootGroup, element, fromPixel);\n      }\n    }, this);\n  },\n  drawOne: function drawOne(rootGroup, element, fromPixel) {\n    if (this.options.datasVisibilityMask[0] && element.datas[0] !== undefined && element.datas[0] !== null) {\n      rootGroup.add(new zrender.Text({\n        style: {\n          x: fromPixel.x - this.options.xOffset,\n          y: fromPixel.y - this.options.yOffset,\n          text: '' + element.datas[0],\n          textAlign: 'right',\n          textVerticalAlign: 'bottom',\n          fontSize: '14',\n          textFill: this.options.datasColor[0]\n        }\n      }));\n    }\n\n    if (this.options.datasVisibilityMask[1] && element.datas[1] !== undefined && element.datas[1] !== null) {\n      rootGroup.add(new zrender.Text({\n        style: {\n          x: fromPixel.x + this.options.xOffset,\n          y: fromPixel.y - this.options.yOffset,\n          text: '' + element.datas[1],\n          textAlign: 'left',\n          textVerticalAlign: 'bottom',\n          fontSize: '14',\n          textFill: this.options.datasColor[1]\n        }\n      }));\n    }\n\n    var hasBottomValue = false;\n\n    if (this.options.datasVisibilityMask[2] && element.datas[2] !== undefined && element.datas[2] !== null) {\n      rootGroup.add(new zrender.Text({\n        style: {\n          x: fromPixel.x - this.options.xOffset,\n          //\n          y: fromPixel.y + this.options.yOffset,\n          text: '' + element.datas[2],\n          textAlign: 'right',\n          textVerticalAlign: 'top',\n          fontSize: '14',\n          textFill: this.options.datasColor[2]\n        }\n      }));\n      hasBottomValue = true;\n    }\n\n    if (this.options.datasVisibilityMask[3] && element.datas[3] !== undefined && element.datas[3] !== null) {\n      rootGroup.add(new zrender.Text({\n        style: {\n          x: fromPixel.x + this.options.xOffset,\n          y: fromPixel.y + this.options.yOffset,\n          text: '' + element.datas[3],\n          textAlign: 'left',\n          textVerticalAlign: 'top',\n          fontSize: '14',\n          textFill: this.options.datasColor[3]\n        }\n      }));\n      hasBottomValue = true;\n    }\n\n    if (this.options.datasVisibilityMask[4] && element.datas[4] !== undefined && element.datas[4] !== null) {\n      rootGroup.add(new zrender.Text({\n        style: {\n          x: fromPixel.x,\n          y: fromPixel.y - this.options.yOffset - 15,\n          text: '' + element.datas[4],\n          textAlign: 'center',\n          textVerticalAlign: 'bottom',\n          fontSize: '14',\n          textFill: this.options.datasColor[4]\n        }\n      }));\n      hasBottomValue = true;\n    }\n\n    if (this.options.showWind && element.windSD) {\n      var vaneColor = 'black';\n\n      if (element.vaneColorFn) {\n        vaneColor = element.vaneColorFn(element.windSD.speed, element.windSD.dir);\n      }\n\n      rootGroup.add(new zrender.WindVane({\n        style: {\n          fill: vaneColor,\n          stroke: vaneColor,\n          strokeWidth: 1\n        },\n        shape: {\n          speed: element.windSD.speed\n        },\n        position: [fromPixel.x, fromPixel.y],\n        rotation: -Math.PI * (element.windSD.dir / 180)\n      }));\n    }\n\n    if (this.options.showStationName) {\n      var yOffset = this.options.yOffset + 5;\n\n      if (hasBottomValue) {\n        yOffset += this.options.yOffset + 5;\n      }\n\n      rootGroup.add(new zrender.Text({\n        style: {\n          x: fromPixel.x,\n          y: fromPixel.y + yOffset,\n          text: '' + element.stationName,\n          textAlign: 'center',\n          textVerticalAlign: 'top',\n          fontSize: '14',\n          textFill: this.options.stationNameColor\n        }\n      }));\n    }\n\n    if (element.stationImageUrl) {\n      var imgW = typeof element.stationImageWidth == 'number' ? element.stationImageWidth : 14;\n      var imgH = typeof element.stationImageHeight == 'number' ? element.stationImageHeight : 14;\n      rootGroup.add(new zrender.Image({\n        style: {\n          x: fromPixel.x - imgW / 2,\n          y: fromPixel.y - imgH / 2,\n          image: element.stationImageUrl,\n          width: imgW,\n          height: imgH\n        },\n        onclick: function () {\n          this.options.clickHandler && this.options.clickHandler(element);\n        }.bind(this)\n      }));\n    } else {\n      if (element.datas.length) {\n        //如果不为空数组时才画圆\n        rootGroup.add(new zrender.Circle({\n          shape: {\n            cx: fromPixel.x,\n            cy: fromPixel.y,\n            r: 3\n          },\n          style: {\n            fill: this.options.centerPointColor\n          },\n          onclick: function () {\n            this.options.clickHandler && this.options.clickHandler(element);\n          }.bind(this)\n        }));\n      }\n    }\n  }\n});\n\nL.RH.zdzLayer = function (options) {\n  return new L.RH.ZdzLayer(options);\n};\n\nL.RH.LightningLayer = L.RH.ZrBaseLayer.extend({\n  // 配置参数\n  options: {\n    centerPointColorFn: function centerPointColorFn(type) {\n      if ('+' === type) {\n        return 'blue';\n      } else if ('-' === type) {\n        return 'blue'; //'red';\n      }\n\n      return 'blue';\n    }\n  },\n  getOptions: function getOptions() {\n    return this.options;\n  },\n  parseM4Data: function parseM4Data(rawdata) {\n    rawdata = rawdata.trim();\n    var lines = rawdata.split('\\n');\n    var datas = [];\n\n    for (var i = 4; i < lines.length; i++) {\n      var line = lines[i];\n\n      if (line) {\n        line = line.trim();\n\n        if (line) {\n          var arr = line.split(' ');\n\n          if (arr.length === 5) {\n            datas.push({\n              lng: _parseFloat(arr[1]),\n              lat: _parseFloat(arr[2]),\n              type: arr[4]\n            });\n          }\n        }\n      }\n    }\n\n    this.setData(datas);\n  },\n  setData: function setData(datas) {\n    this.datas = datas;\n\n    if (this.rootGroup) {\n      this._update(this.rootGroup);\n    }\n  },\n  getData: function getData() {\n    return this.datas;\n  },\n  refresh: function refresh() {\n    if (this.rootGroup) {\n      this._update(this.rootGroup);\n    }\n  },\n  rhUpdate: function rhUpdate(rootGroup) {\n    if (!this.datas) {\n      return;\n    }\n\n    this.datas.forEach(function (element) {\n      var from = L.latLng(element.lat, element.lng);\n\n      var fromPixel = this._map.latLngToContainerPoint(from);\n\n      this.drawOne(rootGroup, element, fromPixel);\n    }, this);\n  },\n  drawOne: function drawOne(rootGroup, element, fromPixel) {\n    //\t  rootGroup.add(new zrender.Text({\n    //        style: {\n    //          x: fromPixel.x,\n    //          y: fromPixel.y,\n    //          text: '' + element.type,\n    //          textAlign: 'center',\n    //          textVerticalAlign: 'middle',\n    //          fontSize: '14',\n    //          textFill: this.options.centerPointColorFn(element.type)\n    //        }\n    //      }));\n    rootGroup.add(new zrender.Circle({\n      shape: {\n        cx: fromPixel.x,\n        cy: fromPixel.y,\n        r: 3\n      },\n      style: {\n        fill: this.options.centerPointColorFn(element.type)\n      }\n    }));\n  }\n});\n\nL.RH.lightningLayer = function (options) {\n  return new L.RH.LightningLayer(options);\n};",{"version":3,"sources":["D:\\program\\frontend\\src\\assets\\js\\leaflet-rh.js"],"names":["zrender","Path","extend","type","shape","x","y","speed","width","height","buildPath","ctx","dir","moveTo","lineTo","wholeLines","Math","floor","halfLine","carriage","interval","_wholeLines","xShift","yShift","tan","PI","i","fill","stroke","L","RH","Util","getWindSpeedAndDegree","u","v","sqrt","atan","isNationalStationId","stationId","length","charAt","graddingStationDataWithZoom","datas","map","options","defaultOptions","cellSize","includeShowAnyway","key","sortedDatas","sort","compareNumbers","a","b","showAnyway","ret","existBounds","forEach","element","pixelPoint","latLngToContainerPoint","lat","lng","eleBound","bounds","point","push","intersects","oneBound","NoTranslateCanvas","Canvas","padding","interactive","_initContainer","prototype","call","_container","style","pointerEvents","_update","_map","_animatingZoom","_bounds","_drawnLayers","Renderer","container","size","getSize","m","DomUtil","setPosition","min","noTranslateCanvas","Browser","canvas","ZrCanvas","initialize","_initZr","onAdd","getPane","appendChild","addClass","zr","init","zrCanvas","CanvasLayer","renderer","getEvents","zoomend","_zoomend","moveend","beforeAdd","_renderer","getRenderer","onRemove","hasLayer","removeLayer","falseFn","clear","_ctx","clearRect","ZrBaseLayer","setOptions","render","pane","rootGroup","removeAll","dispose","Group","add","rhUpdate","zrBaseLayer","ZdzLayer","xOffset","yOffset","showStationName","showWind","stationNameColor","datasVisibilityMask","datasColor","graddingOptions","centerPointColor","clickHandler","getOptions","setData","_zoomMapDatas","wind","windSD","addData","items","getBounds","pixelBounds","getNorthWest","getSouthEast","from","latLng","fromPixel","contains","drawOne","getData","refresh","filteredDatas","getZoom","undefined","Text","text","textAlign","textVerticalAlign","fontSize","textFill","hasBottomValue","vaneColor","vaneColorFn","WindVane","strokeWidth","position","rotation","stationName","stationImageUrl","imgW","stationImageWidth","imgH","stationImageHeight","Image","image","onclick","bind","Circle","cx","cy","r","zdzLayer","LightningLayer","centerPointColorFn","parseM4Data","rawdata","trim","lines","split","line","arr","lightningLayer"],"mappings":"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","sourcesContent":["import zrender from 'zrender';\r\n/**\r\n * zrender shape extend: WindVane\r\n */\r\nzrender['WindVane'] = zrender.Path.extend({\r\n  type: 'windVane',\r\n\r\n  shape: {\r\n    x: 0,\r\n    y: 0,\r\n    speed: 0,\r\n    width: 8,\r\n    height: 25\r\n  },\r\n\r\n  buildPath: function (ctx, shape) {\r\n    var x = shape.x;\r\n    var y = shape.y;\r\n    var width = shape.width;\r\n    var height = shape.height;\r\n    var speed = shape.speed;\r\n    var dir = shape.dir;\r\n\r\n    if (speed != null && speed > 0) {\r\n      ctx.moveTo(x, y);\r\n      ctx.lineTo(x, y - height);\r\n\r\n      var wholeLines = Math.floor(speed / 4);\r\n      var halfLine = ((speed % 4) > 0);\r\n\r\n      var carriage = height;\r\n      var interval = width / 2;\r\n      var _wholeLines = wholeLines;\r\n      var xShift = width;\r\n      var yShift = xShift * Math.tan(30 * Math.PI / 180);\r\n      for (var i = 0; i < wholeLines; i++) {\r\n        ctx.moveTo(x, y - carriage);\r\n        if (_wholeLines >= 5) {\r\n          ctx.lineTo(x + xShift, y - carriage);\r\n          ctx.lineTo(x, y - carriage + yShift);\r\n          ctx.fill();\r\n          i += 4;\r\n          _wholeLines -= 5;\r\n          carriage -= yShift;\r\n        } else {\r\n          ctx.lineTo(x + xShift, y - carriage - yShift);\r\n          carriage -= interval;\r\n        }\r\n\r\n      }\r\n\r\n      if (halfLine) {\r\n        if (wholeLines == 0) carriage -= interval;\r\n        ctx.moveTo(x, y - carriage);\r\n        ctx.lineTo(x + xShift / 2 + 1, y - carriage - yShift / 2);\r\n      }\r\n\r\n      ctx.stroke();\r\n    }\r\n  }\r\n});\r\n\r\n\r\n/**\r\n * Leaflet RiHang Extentions\r\n */\r\nL.RH = {\r\n  Util: {\r\n    getWindSpeedAndDegree: function (u, v) {\r\n      var speed = Math.sqrt(u * u + v * v);\r\n      var dir = 0;\r\n\r\n      if (u == 0) {\r\n        dir = v < 0 ? 0 : 180;\r\n      } else {\r\n        dir = Math.atan(v / u) / Math.PI * 180;\r\n        dir = u > 0 ? (270 - dir) : (90 - dir);\r\n      }\r\n      return { speed: speed, dir: dir };\r\n    },\r\n\r\n    isNationalStationId: function (stationId) {\r\n      if (!stationId) {\r\n        return false;\r\n      }\r\n\r\n      if (stationId.length === 6) {\r\n        return true;\r\n      }\r\n\r\n      if (stationId.charAt(0) >= 'A' && stationId.charAt(0) <= 'Z') {\r\n        return true;\r\n      }\r\n\r\n      return false\r\n    },\r\n\r\n    graddingStationDataWithZoom: function (datas, map, options) {\r\n      var defaultOptions = {\r\n        cellSize: 60,\r\n        includeShowAnyway: true\r\n      };\r\n\r\n      for (var key in options) {\r\n        defaultOptions[key] = options[key];\r\n      }\r\n\r\n      var sortedDatas = datas.sort(function compareNumbers(a, b) {\r\n        if (a.showAnyway === true && b.showAnyway === true) {\r\n          return 0;\r\n        } else if (a.showAnyway === true) {\r\n          return 1;\r\n        } else if (b.showAnyway === true) {\r\n          return -1;\r\n        } else {\r\n          if (L.RH.Util.isNationalStationId(a.stationId) && L.RH.Util.isNationalStationId(b.stationId)) {\r\n            return 0;\r\n          } else if (L.RH.Util.isNationalStationId(a.stationId)) {\r\n            return 1;\r\n          } else if (L.RH.Util.isNationalStationId(b.stationId)) {\r\n            return -1;\r\n          }\r\n\r\n          return 0;\r\n        }\r\n      });\r\n\r\n      var ret = [];\r\n\r\n      var existBounds = [];\r\n\r\n      sortedDatas.forEach(function (element) {\r\n        var pixelPoint = map.latLngToContainerPoint([element.lat, element.lng]);\r\n        var eleBound = L.bounds(L.point(pixelPoint.x - defaultOptions.cellSize / 2, pixelPoint.y - defaultOptions.cellSize / 2), L.point(pixelPoint.x + defaultOptions.cellSize / 2, pixelPoint.y + defaultOptions.cellSize / 2));\r\n\r\n        if (element.showAnyway) {\r\n          ret.push(element);\r\n\r\n          if (defaultOptions.includeShowAnyway) {\r\n            existBounds.push(eleBound);\r\n          }\r\n\r\n        } else {\r\n\r\n          var intersects = false;\r\n\r\n          for (var i = 0; i < existBounds.length; i++) {\r\n            var oneBound = existBounds[i];\r\n\r\n            if (oneBound.intersects(eleBound)) {\r\n              intersects = true;\r\n              return;\r\n            }\r\n          }\r\n\r\n          if (!intersects) {\r\n            ret.push(element);\r\n            existBounds.push(eleBound);\r\n          }\r\n        }\r\n\r\n      });\r\n\r\n      return ret;\r\n    }\r\n  }\r\n}\r\n\r\nL.RH.NoTranslateCanvas = L.Canvas.extend({\r\n  options: {\r\n    padding: 0,\r\n    interactive: true,\r\n  },\r\n\r\n  _initContainer: function () {\r\n    L.Canvas.prototype._initContainer.call(this);\r\n    if (!this.options.interactive)\r\n      this._container.style.pointerEvents = 'none';\r\n  },\r\n\r\n  _update: function () {\r\n    if (this._map._animatingZoom && this._bounds) {\r\n      return;\r\n    }\r\n\r\n    this._drawnLayers = {};\r\n\r\n    L.Renderer.prototype._update.call(this);\r\n\r\n    var b = this._bounds,\r\n      container = this._container,\r\n      size = b.getSize(),\r\n      // m = L.Browser.retina ? 2 : 1;\r\n      m = 1; // modified by helen in 2016/9/30\r\n\r\n    L.DomUtil.setPosition(container, b.min);\r\n\r\n    // set canvas size (also clearing it); use double size on retina\r\n    container.width = m * size.x;\r\n    container.height = m * size.y;\r\n    container.style.width = size.x + 'px';\r\n    container.style.height = size.y + 'px';\r\n\r\n    //if (L.Browser.retina) {\r\n    //    this._ctx.scale(2, 2);\r\n    //    this._ctx.translate(-b.min.x, -b.min.y);\r\n    //}\r\n\r\n    // translate so we use the same path coordinates after canvas element moves\r\n    //this._ctx.translate(-b.min.x, -b.min.y);\r\n\r\n    // Tell paths to redraw themselves\r\n    // this.fire('update');\r\n  }\r\n});\r\nL.RH.noTranslateCanvas = function (options) {\r\n  return L.Browser.canvas ? new L.RH.NoTranslateCanvas(options) : null;\r\n};\r\n\r\n\r\nL.RH.ZrCanvas = L.RH.NoTranslateCanvas.extend({\r\n  initialize: function (options) {\r\n    L.RH.NoTranslateCanvas.prototype.initialize.call(this, options);\r\n\r\n    this._initZr();\r\n  },\r\n\r\n  onAdd: function () {\r\n    this._initZr();\r\n\r\n    this.getPane().appendChild(this._container);\r\n    this._update();\r\n  },\r\n\r\n  _initZr: function () {\r\n    if (!this._container) {\r\n      this._initContainer(); // defined by renderer implementations\r\n\r\n      // if (this._zoomAnimated) {\r\n      //   L.DomUtil.addClass(this._container, 'leaflet-zoom-animated');\r\n      // }\r\n\r\n      L.DomUtil.addClass(this._container, 'leaflet-zoom-hide');\r\n    }\r\n\r\n    if (this._container) {\r\n      this.zr = zrender.init(this._container);\r\n    }\r\n  }\r\n});\r\nL.RH.zrCanvas = function (options) {\r\n  return L.Browser.canvas ? new L.RH.ZrCanvas(options) : null;\r\n};\r\n\r\nL.RH.CanvasLayer = L.Path.extend({\r\n  options: {\r\n    renderer: L.RH.noTranslateCanvas()\r\n  },\r\n\r\n  getEvents: function () {\r\n    return {\r\n      zoomend: this._zoomend,\r\n      moveend: this._update\r\n    };\r\n  },\r\n\r\n  beforeAdd: function (map) {\r\n    this._map = map;\r\n    L.Path.prototype.beforeAdd.call(this, map);\r\n  },\r\n\r\n  onAdd: function () {\r\n    this._renderer = this._map.getRenderer(this);\r\n    this._update();\r\n  },\r\n\r\n  onRemove: function () {\r\n    if (this._map.hasLayer(this._renderer))\r\n      this._map.removeLayer(this._renderer);\r\n  },\r\n\r\n  _zoomend: function () { },\r\n  _update: L.Util.falseFn(),\r\n\r\n  clear: function () {\r\n    var size = this.size = this._renderer._bounds.getSize();\r\n    this._renderer._ctx.clearRect(0, 0, size.x, size.y);\r\n  }\r\n\r\n});\r\n\r\nL.RH.ZrBaseLayer = L.RH.CanvasLayer.extend({\r\n  options: {\r\n    renderer: null\r\n  },\r\n\r\n  initialize: function (options) {\r\n    L.setOptions(this, options);\r\n\r\n    if (!this.options.render) {\r\n      this.options.renderer = L.RH.zrCanvas({\r\n        pane: 'overlayPane'\r\n      });\r\n    }\r\n  },\r\n\r\n  onRemove: function () {\r\n    this.clear();\r\n    this.rootGroup.removeAll();\r\n    this._renderer.zr.dispose();\r\n  },\r\n\r\n  _update: function () {\r\n    if (!this.rootGroup) {\r\n      this.rootGroup = new zrender.Group();\r\n      this._renderer.zr.add(this.rootGroup);\r\n    } else {\r\n      this.rootGroup.removeAll();\r\n    }\r\n\r\n    this.rhUpdate(this.rootGroup);\r\n  },\r\n\r\n  // Your logic should be here\r\n  rhUpdate: function (rootGroup) {\r\n\r\n  }\r\n});\r\n\r\nL.RH.zrBaseLayer = function (options) {\r\n  return new L.RH.ZrBaseLayer(options);\r\n};\r\n\r\n\r\n/**\r\n * \r\n * 使用该功能组件时要遵循的数据格式\r\n * \r\n  datas = [{\r\n          stationId: 54511,\r\n          stationName: '气象台',\r\n          lng: 75.77 ,\r\n          lat: 37.98,\r\n          datas: [1, null, 1, null],\r\n          datasVisibilityMask: [true, false, true, false]  //控制要素的显示，与datas一一对应\r\n          showAnyway:true  //true表示显示全部|false表示抽稀\r\n          wind: [u, v],\r\n          stationImageUrl: Math.random() < 0.3 ? './assets/img/ico.png' : null\r\n        }]\r\n */\r\nL.RH.ZdzLayer = L.RH.ZrBaseLayer.extend({\r\n  // 配置参数\r\n  options: {\r\n    xOffset: 5,\r\n    yOffset: 5,\r\n    showStationName: true,\r\n    showWind:true,\r\n    stationNameColor: 'black',\r\n    datasVisibilityMask: [true, true, true, true, true],\r\n    datasColor: ['#A52A2A', '#0000A0', '#008000', 'black', '#f0f'],  //与datasVisibilityMask一一对应\r\n    graddingOptions: {\r\n      cellSize: 60,\r\n      includeShowAnyway: true\r\n    },\r\n    centerPointColor: 'red',  //当数据中没有stationImageUrl字段或为null时，设置中心圆的颜色\r\n    clickHandler: function (element) { }\r\n  },\r\n\r\n  getOptions: function () {\r\n    return this.options;\r\n  },\r\n\r\n  setData: function (datas) {\r\n    this.datas = datas;\r\n    this._zoomMapDatas = {};\r\n\r\n    this.datas.forEach(function (element) {\r\n      if (element.wind) {\r\n        element.windSD = L.RH.Util.getWindSpeedAndDegree(element.wind[0], element.wind[1])\r\n      }\r\n    }, this);\r\n\r\n    if (this.rootGroup) {\r\n      this._update(this.rootGroup);\r\n    }\r\n  },\r\n\r\n  addData: function (items) {\r\n    this.datas = this.datas || [];\r\n    this._zoomMapDatas = {};\r\n\r\n    var bounds = this._map.getBounds();\r\n    var pixelBounds = L.bounds(this._map.latLngToContainerPoint(bounds.getNorthWest()), this._map.latLngToContainerPoint(bounds.getSouthEast()))\r\n\r\n    items.forEach(function(element) {\r\n      if (element.wind) {\r\n        element.windSD = L.RH.Util.getWindSpeedAndDegree(element.wind[0], element.wind[1])\r\n      }\r\n\r\n      this.datas.push(element);\r\n\r\n      var from = L.latLng(element.lat, element.lng);\r\n\r\n      var fromPixel = this._map.latLngToContainerPoint(from);\r\n\r\n      if (pixelBounds.contains(fromPixel)) {\r\n        this.drawOne(this.rootGroup, element, fromPixel);\r\n      }\r\n    }, this)\r\n  },\r\n\r\n  getData: function() {\r\n    return this.datas;\r\n  },\r\n\r\n  refresh: function() {\r\n    this._zoomMapDatas = {};\r\n    \r\n    if (this.rootGroup) {\r\n      this._update(this.rootGroup);\r\n    }\r\n  },\r\n\r\n  rhUpdate: function (rootGroup) {\r\n    if (!this.datas) {\r\n      return;\r\n    }\r\n\r\n    var filteredDatas = this._zoomMapDatas[this._map.getZoom()];\r\n\r\n    if (!filteredDatas) {\r\n      filteredDatas = L.RH.Util.graddingStationDataWithZoom(this.datas, this._map, this.options.graddingOptions);\r\n      this._zoomMapDatas[this._map.getZoom()] = filteredDatas;\r\n    }\r\n\r\n    var bounds = this._map.getBounds();\r\n    var pixelBounds = L.bounds(this._map.latLngToContainerPoint(bounds.getNorthWest()), this._map.latLngToContainerPoint(bounds.getSouthEast()))\r\n\r\n    filteredDatas.forEach(function (element) {\r\n      var from = L.latLng(element.lat, element.lng);\r\n\r\n      var fromPixel = this._map.latLngToContainerPoint(from);\r\n\r\n      if (pixelBounds.contains(fromPixel)) {\r\n        this.drawOne(rootGroup, element, fromPixel);\r\n      }\r\n    }, this);\r\n\r\n  },\r\n\r\n  drawOne: function(rootGroup, element, fromPixel) {\r\n    if (this.options.datasVisibilityMask[0] && element.datas[0] !== undefined && element.datas[0] !== null) {\r\n      rootGroup.add(new zrender.Text({\r\n        style: {\r\n          x: fromPixel.x - this.options.xOffset,\r\n          y: fromPixel.y - this.options.yOffset,\r\n          text: '' + element.datas[0],\r\n          textAlign: 'right',\r\n          textVerticalAlign: 'bottom',\r\n          fontSize: '14',\r\n          textFill: this.options.datasColor[0]\r\n        }\r\n      }));\r\n    }\r\n\r\n    if (this.options.datasVisibilityMask[1] && element.datas[1] !== undefined && element.datas[1] !== null) {\r\n      rootGroup.add(new zrender.Text({\r\n        style: {\r\n          x: fromPixel.x + this.options.xOffset,\r\n          y: fromPixel.y - this.options.yOffset,\r\n          text: '' + element.datas[1],\r\n          textAlign: 'left',\r\n          textVerticalAlign: 'bottom',\r\n          fontSize: '14',\r\n          textFill: this.options.datasColor[1]\r\n        }\r\n      }));\r\n    }\r\n\r\n    var hasBottomValue = false;\r\n\r\n    if (this.options.datasVisibilityMask[2] && element.datas[2] !== undefined && element.datas[2] !== null) {\r\n      rootGroup.add(new zrender.Text({\r\n        style: {\r\n          x: fromPixel.x - this.options.xOffset,  //\r\n          y: fromPixel.y + this.options.yOffset,\r\n          text: '' + element.datas[2],\r\n          textAlign: 'right',\r\n          textVerticalAlign: 'top',\r\n          fontSize: '14',\r\n          textFill: this.options.datasColor[2]\r\n        }\r\n      }));\r\n\r\n      hasBottomValue = true;\r\n    }\r\n\r\n    if (this.options.datasVisibilityMask[3] && element.datas[3] !== undefined && element.datas[3] !== null) {\r\n      rootGroup.add(new zrender.Text({\r\n        style: {\r\n          x: fromPixel.x + this.options.xOffset,\r\n          y: fromPixel.y + this.options.yOffset,\r\n          text: '' + element.datas[3],\r\n          textAlign: 'left',\r\n          textVerticalAlign: 'top',\r\n          fontSize: '14',\r\n          textFill: this.options.datasColor[3]\r\n        }\r\n      }));\r\n\r\n      hasBottomValue = true;\r\n    }\r\n\r\n    if (this.options.datasVisibilityMask[4] && element.datas[4] !== undefined && element.datas[4] !== null) {\r\n      rootGroup.add(new zrender.Text({\r\n        style: {\r\n          x: fromPixel.x,\r\n          y: fromPixel.y - this.options.yOffset - 15,\r\n          text: '' + element.datas[4],\r\n          textAlign: 'center',\r\n          textVerticalAlign: 'bottom',\r\n          fontSize: '14',\r\n          textFill: this.options.datasColor[4]\r\n        }\r\n      }));\r\n\r\n      hasBottomValue = true;\r\n    }\r\n\r\n    if (this.options.showWind && element.windSD) {\r\n    \t\r\n      var vaneColor = 'black';\r\n      if (element.vaneColorFn) {\r\n    \t  vaneColor = element.vaneColorFn(element.windSD.speed, element.windSD.dir);\r\n      }\r\n\r\n      rootGroup.add(new zrender.WindVane({\r\n        style: {\r\n          fill: vaneColor,\r\n          stroke: vaneColor,\r\n          strokeWidth: 1\r\n        },\r\n        shape: {\r\n          speed: element.windSD.speed\r\n        },\r\n        position: [fromPixel.x, fromPixel.y],\r\n        rotation: -Math.PI * (element.windSD.dir / 180)\r\n      }));\r\n    }\r\n\r\n    if (this.options.showStationName) {\r\n      var yOffset = this.options.yOffset + 5;\r\n\r\n      if (hasBottomValue) {\r\n        yOffset += this.options.yOffset + 5;\r\n      }\r\n      \r\n      rootGroup.add(new zrender.Text({\r\n        style: {\r\n          x: fromPixel.x,\r\n          y: fromPixel.y + yOffset,\r\n          text: '' + element.stationName,\r\n          textAlign: 'center',\r\n          textVerticalAlign: 'top',\r\n          fontSize: '14',\r\n          textFill: this.options.stationNameColor\r\n        }\r\n      }));\r\n\r\n    }\r\n\r\n    if (element.stationImageUrl) {\r\n\r\n      var imgW = typeof element.stationImageWidth == 'number' ? element.stationImageWidth : 14;\r\n      var imgH = typeof element.stationImageHeight == 'number' ? element.stationImageHeight :14;\r\n\r\n      rootGroup.add(new zrender.Image({\r\n        style: {\r\n          x: fromPixel.x - imgW / 2,\r\n          y: fromPixel.y - imgH / 2,\r\n          image: element.stationImageUrl,\r\n          width: imgW,\r\n          height: imgH\r\n        },\r\n        onclick: (function () {\r\n          this.options.clickHandler && this.options.clickHandler(element)\r\n        }).bind(this)\r\n      }));\r\n    } else {\r\n\r\n      if (element.datas.length) {  //如果不为空数组时才画圆\r\n        rootGroup.add(new zrender.Circle({\r\n          shape: {\r\n            cx: fromPixel.x,\r\n            cy: fromPixel.y,\r\n            r: 3\r\n          },\r\n          style: {\r\n            fill: this.options.centerPointColor\r\n          },\r\n          onclick: (function () {\r\n            this.options.clickHandler && this.options.clickHandler(element)\r\n          }).bind(this)\r\n        }));\r\n      }\r\n\r\n    }\r\n  }\r\n});\r\n\r\nL.RH.zdzLayer = function (options) {\r\n  return new L.RH.ZdzLayer(options);\r\n};\r\n\r\n\r\nL.RH.LightningLayer = L.RH.ZrBaseLayer.extend({\r\n  // 配置参数\r\n  options: {\r\n    centerPointColorFn: function(type) {\r\n    \tif ('+' === type) {\r\n    \t\treturn 'blue';\r\n    \t} else if ('-' === type) {\r\n    \t\treturn 'blue'; //'red';\r\n    \t}\r\n    \t\r\n    \treturn 'blue';\r\n    }\r\n  },\r\n\r\n  getOptions: function () {\r\n    return this.options;\r\n  },\r\n  \r\n  parseM4Data: function(rawdata) {\r\n\trawdata = rawdata.trim();\r\n\t\r\n\tvar lines = rawdata.split('\\n');\r\n\t\t\r\n\tvar datas = [];\r\n\t\r\n\tfor (var i = 4; i < lines.length; i++) {\r\n\t\tvar line = lines[i];\r\n\t\t\r\n\t\tif (line) {\r\n\t\t\tline = line.trim();\r\n\t\t\t\r\n\t\t\tif (line) {\r\n\t\t\t\tvar arr = line.split(' ');\r\n\t\t\t\t\r\n\t\t\t\tif (arr.length === 5) {\r\n\t\t\t\t\tdatas.push({\r\n\t\t\t\t\t\tlng: parseFloat(arr[1]),\r\n\t\t\t\t\t\tlat: parseFloat(arr[2]),\r\n\t\t\t\t\t\ttype: arr[4]\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tthis.setData(datas);\r\n  },\r\n\r\n  setData: function (datas) {\r\n    this.datas = datas;\r\n\r\n    if (this.rootGroup) {\r\n      this._update(this.rootGroup);\r\n    }\r\n  },\r\n\r\n  getData: function() {\r\n    return this.datas;\r\n  },\r\n\r\n  refresh: function() {\r\n    if (this.rootGroup) {\r\n      this._update(this.rootGroup);\r\n    }\r\n  },\r\n\r\n  rhUpdate: function (rootGroup) {\r\n    if (!this.datas) {\r\n      return;\r\n    }\r\n    \r\n    this.datas.forEach(function (element) {\r\n      var from = L.latLng(element.lat, element.lng);\r\n\r\n      var fromPixel = this._map.latLngToContainerPoint(from);\r\n\r\n      this.drawOne(rootGroup, element, fromPixel);\r\n    }, this);\r\n\r\n  },\r\n\r\n  drawOne: function(rootGroup, element, fromPixel) {\r\n//\t  rootGroup.add(new zrender.Text({\r\n//        style: {\r\n//          x: fromPixel.x,\r\n//          y: fromPixel.y,\r\n//          text: '' + element.type,\r\n//          textAlign: 'center',\r\n//          textVerticalAlign: 'middle',\r\n//          fontSize: '14',\r\n//          textFill: this.options.centerPointColorFn(element.type)\r\n//        }\r\n//      }));\r\n\trootGroup.add(new zrender.Circle({\r\n      shape: {\r\n        cx: fromPixel.x,\r\n        cy: fromPixel.y,\r\n        r: 3\r\n      },\r\n      style: {\r\n        fill: this.options.centerPointColorFn(element.type)\r\n      }\r\n    }));\r\n  }\r\n});\r\n\r\nL.RH.lightningLayer = function (options) {\r\n  return new L.RH.LightningLayer(options);\r\n};"]}]}