{"remainingRequest":"D:\\program\\frontend\\node_modules\\babel-loader\\lib\\index.js!D:\\program\\frontend\\src\\views\\synthesis\\maps\\Maps.js?vue&type=script&lang=js&","dependencies":[{"path":"D:\\program\\frontend\\src\\views\\synthesis\\maps\\Maps.js","mtime":1553855602343},{"path":"D:\\program\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\program\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _Array$isArray from \"D:\\\\program\\\\frontend\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/array/is-array\";\nimport \"core-js/modules/es6.array.sort\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.array.find\";\nimport _Object$assign from \"D:\\\\program\\\\frontend\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/object/assign\";\nimport \"core-js/modules/web.dom.iterable\";\nimport _objectSpread from \"D:\\\\program\\\\frontend\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/objectSpread\";\nimport * as moment from \"moment\";\nimport L from \"leaflet\";\nimport _ from \"lodash\";\nimport * as axios from \"axios\";\nimport { createNamespacedHelpers } from \"vuex\";\n\nvar _createNamespacedHelp = createNamespacedHelpers(\"synthesis\"),\n    mapState = _createNamespacedHelp.mapState,\n    mapGetters = _createNamespacedHelp.mapGetters,\n    mapMutations = _createNamespacedHelp.mapMutations;\n\nimport eleOption from \"../element-option\";\nimport \"../../../assets/js/leaflet-rh\";\nimport \"../../../assets/js/leaflet-markercluster/leaflet.markercluster\"; // import * as d3 from 'd3';\n// import * as d3Contour from 'd3-contour';\n// console.log(d3);\n\nexport default {\n  name: \"maps\",\n  components: {},\n  props: {\n    elementInfo: {\n      type: Object\n    }\n  },\n  data: function data() {\n    return {\n      isShowBaseLayerPanel: false,\n      isVoice: true,\n      isSync: true,\n      isFullScreenshot: false,\n      isAreaScreenshot: false,\n      splitScreenNumber: 1,\n      //当前分屏数，1：1分屏，2：2分屏， 4：4分屏\n      mapIds: [\"map1\", \"map2\", \"map3\", \"map4\"],\n      mapLayer1: {},\n      mapLayer2: {},\n      mapLayer3: {},\n      mapLayer4: {}\n    };\n  },\n  computed: _objectSpread({}, mapState([\"ssIndex\"]), mapGetters([\"currSplitScreen\", \"showHideLayerHash\", \"stationPup\", \"station\", \"severeWeather\", \"fcstWarning\", \"valueFcst\"]), {\n    currMapId: function currMapId() {\n      return \"map\" + this.ssIndex;\n    },\n    currMapLayer: function currMapLayer() {\n      return this[\"mapLayer\" + this.ssIndex];\n    },\n    currMap: function currMap() {\n      return this[\"map\" + this.ssIndex];\n    }\n  }),\n  watch: {\n    currMapId: function currMapId() {\n      if (this.isSync) {\n        this.syncMap();\n      }\n    },\n    isSync: function isSync(_isSync) {\n      var _this = this;\n\n      if (_isSync) {\n        this.syncMap();\n      } else {\n        this.mapIds.forEach(function (id) {\n          _this[id].off(\"moveend\");\n        });\n      }\n    },\n    // 图层的显示隐藏\n    showHideLayerHash: function showHideLayerHash(hash, oldHash) {\n      for (var key in hash) {\n        var newVal = hash[key];\n        var oldVal = oldHash[key];\n\n        if (oldVal !== undefined && newVal !== oldVal) {\n          // console.log(hash, oldHash);\n          var layer = this.currMapLayer[key];\n\n          if (layer) {\n            if (newVal) {\n              layer.remove();\n            } else {\n              layer.addTo(this.currMap);\n            } // console.log(layer);\n\n          }\n        }\n      }\n    }\n  },\n  created: function created() {\n    this.debouncedLc = _.debounce(this.layerController, 300);\n    this.debouncedLcSationPup = _.debounce(this.layerController_stationPup, 300);\n  },\n  mounted: function mounted() {\n    var _this2 = this;\n\n    this.$message.config({\n      top: \"100px\",\n      duration: 1\n    });\n    this.initMap(); // 订阅store中的mutations(只需要其中的一部分)\n\n    this.cancelSubscribe = this.$store.subscribe(function (mutation, state) {\n      switch (mutation.type) {\n        case \"synthesis/fw_update_short_term_time\":\n        case \"synthesis/fw_update_short_term\":\n          //预报预警_短期预报\n          _this2.fcstWarnAndValueFcstInfo(\"fw_short_term\");\n\n          break;\n\n        case \"synthesis/fw_update_short_time_time\":\n        case \"synthesis/fw_update_short_time\":\n          //预报预警_短时预报\n          _this2.fcstWarnAndValueFcstInfo(\"fw_short_time\");\n\n          break;\n\n        case \"synthesis/fw_update_warn_state_time\":\n        case \"synthesis/fw_update_warn_state\":\n          // 预报预警_国家预警\n          _this2.fcstWarnAndValueFcstInfo(\"fw_warn_state\");\n\n          break;\n\n        case \"synthesis/fw_update_warn_province_time\":\n        case \"synthesis/fw_update_warn_province\":\n          // 预报预警_省级预警\n          _this2.fcstWarnAndValueFcstInfo(\"fw_warn_province\");\n\n          break;\n\n        case \"synthesis/vf_update_time\":\n        case \"synthesis/vf_update\":\n          _this2.fcstWarnAndValueFcstInfo(\"vf\"); // 数值预报\n\n\n          break;\n\n        case \"synthesis/select_base_layer\":\n          _this2.renderBaseLayer();\n\n          break;\n\n        case \"synthesis/st_update_hour\":\n          // 自动站:小时选择\n          var checkedHourEleList = _this2.station.hourEleList.filter(function (el) {\n            return el.checked;\n          });\n\n          checkedHourEleList.forEach(function (el) {\n            var eleInfo = _Object$assign(_.cloneDeep(el), {\n              currHour: mutation.payload\n            });\n\n            _this2.updateElementInfo(\"normal\", eleInfo);\n          });\n          break;\n\n        case \"synthesis/sw_update_hour\":\n          // 强天气:小时选择\n          var checkedHourEleList1 = _this2.severeWeather.hourEleList.filter(function (el) {\n            return el.checked;\n          });\n\n          checkedHourEleList1.forEach(function (el) {\n            var eleInfo = _Object$assign(_.cloneDeep(el), {\n              currHour: mutation.payload\n            });\n\n            _this2.updateElementInfo(\"normal\", eleInfo);\n          });\n          break;\n\n        case \"synthesis/sw_update_element_condition\":\n          // 强天气:观测\n          if (mutation.payload.conditionKey === \"currObserve\") {\n            var eleInfo1 = _.cloneDeep(mutation.payload);\n\n            _this2.updateElementInfo(\"normal\", eleInfo1);\n          }\n\n          break;\n\n        case \"synthesis/update_element_time\":\n          // 所有:更新数据时间\n          var eleInfo2 = _Object$assign(_.cloneDeep(mutation.payload), {\n            currHour: _this2.severeWeather.currHour\n          });\n\n          _this2.updateElementInfo(\"normal\", eleInfo2);\n\n          break;\n\n        case \"synthesis/sn_level_change\": // SWAN拼图_层次更新\n\n        case \"synthesis/sn_aging_change\": // SWAN拼图_时效更新\n\n        case \"synthesis/st_threshold_change\": // 自动站: 阀值更新\n\n        case \"synthesis/cp_aging_change\":\n          //云图: 更新时效\n          var eleInfo3 = _.cloneDeep(mutation.payload);\n\n          _this2.updateElementInfo(\"normal\", eleInfo3);\n\n          break;\n\n        case \"synthesis/stp_set_null_element_id\": // 单站pup: 清空当前选中的要素id\n\n        case \"synthesis/stp_update_station_id\": // 单站pup: 更新站点\n\n        case \"synthesis/stp_update_times\":\n          // 单站pup: 更新时间\n          _this2.updateElementInfo(\"stationPup\");\n\n          break;\n      }\n    });\n  },\n  beforeDestroy: function beforeDestroy() {\n    this.cancelSubscribe();\n  },\n  methods: _objectSpread({}, mapMutations([\"cut_split_screen\", \"select_base_layer\", \"select_layer_element\", \"select_all_layer_element\"]), {\n    updateElementInfo: function updateElementInfo(typeName, eleInfo) {\n      // console.log(eleInfo.name);\n      if (typeName === \"normal\") {\n        // this.debouncedLc(eleInfo);\n        this.layerController(eleInfo);\n      } else if (typeName === \"stationPup\") {\n        //单站pup\n        // this.debouncedLcSationPup();\n        this.layerController_stationPup();\n      }\n    },\n    fcstWarnAndValueFcstInfo: function fcstWarnAndValueFcstInfo(type) {\n      var _this3 = this;\n\n      var infoList = [];\n\n      switch (type) {\n        case \"fw_short_term\":\n          {\n            var _this$fcstWarning$sho = this.fcstWarning.shortTerm,\n                date = _this$fcstWarning$sho.date,\n                hour = _this$fcstWarning$sho.hour,\n                aging = _this$fcstWarning$sho.aging;\n            aging = this.formatAging(aging);\n            var typeName = eleOption.fw_short_term.typeName;\n            var checked = aging !== \"\";\n            var _id = \"fw_short_term\";\n\n            if (checked) {\n              if (date) {\n                var latestTime = date.format(\"YYYYMMDD\") + hour + \"00\";\n                infoList.push({\n                  id: _id,\n                  checked: checked,\n                  latestTime: latestTime,\n                  aging: aging\n                });\n              } else {\n                var message = typeName + (aging ? \"(\" + aging + \"h)\" : \"\");\n                this.$message.warning(message + \"暂无数据!\");\n              }\n            } else {\n              infoList.push({\n                id: _id,\n                checked: checked\n              });\n            }\n          }\n          break;\n\n        case \"fw_short_time\":\n          {\n            var _this$fcstWarning$sho2 = this.fcstWarning.shortTime,\n                _date = _this$fcstWarning$sho2.date,\n                eleList = _this$fcstWarning$sho2.eleList;\n            var _typeName = eleOption.fw_short_time.typeName;\n            var checkedEle = eleList.find(function (el) {\n              return el.checked;\n            });\n            var _id2 = \"fw_short_time\";\n\n            if (checkedEle) {\n              //有值即代表选中\n              if (_date) {\n                infoList.push({\n                  id: _id2,\n                  checked: true,\n                  latestTime: _date,\n                  pathId: checkedEle.pathId\n                });\n              } else {\n                var _message = _typeName + \"(\" + checkedEle.name + \")\";\n\n                this.$message.warning(_message + \"暂无数据!\");\n              }\n            } else {\n              infoList.push({\n                checked: false,\n                id: _id2\n              });\n            }\n          }\n          break;\n\n        case \"fw_warn_state\":\n          {\n            var _this$fcstWarning$sta = this.fcstWarning.stateWarn,\n                _date2 = _this$fcstWarning$sta.date,\n                _hour = _this$fcstWarning$sta.hour,\n                _aging = _this$fcstWarning$sta.aging;\n            _aging = this.formatAging(_aging);\n            var _typeName2 = eleOption.fw_warn_state.typeName;\n\n            var _checked = _aging !== \"\";\n\n            var _id3 = \"fw_warn_state\";\n\n            if (_checked) {\n              if (_date2) {\n                var _latestTime = _date2.format(\"YYYYMMDD\") + _hour + \"00\";\n\n                infoList.push({\n                  id: _id3,\n                  checked: _checked,\n                  latestTime: _latestTime,\n                  aging: _aging\n                });\n              } else {\n                var _message2 = _typeName2 + \"(\" + _aging + \"h)\";\n\n                this.$message.warning(_message2 + \"暂无数据!\");\n              }\n            } else {\n              infoList.push({\n                checked: _checked,\n                id: _id3\n              });\n            }\n          }\n          break;\n\n        case \"fw_warn_province\":\n          {\n            var _this$fcstWarning$pro = this.fcstWarning.provinceWarn,\n                _date3 = _this$fcstWarning$pro.date,\n                _hour2 = _this$fcstWarning$pro.hour,\n                minute = _this$fcstWarning$pro.minute,\n                _aging2 = _this$fcstWarning$pro.aging,\n                _eleList = _this$fcstWarning$pro.eleList;\n            var _typeName3 = eleOption.fw_warn_province.typeName;\n\n            var _checkedEle = _eleList.find(function (el) {\n              return el.checked;\n            });\n\n            var _id4 = \"fw_warn_province\";\n\n            if (_checkedEle) {\n              if (_date3) {\n                var _latestTime2 = _date3.format(\"YYYYMMDD\") + _hour2 + minute;\n\n                infoList.push({\n                  id: _id4,\n                  checked: true,\n                  latestTime: _latestTime2,\n                  pathId: _checkedEle.pathId,\n                  aging: _aging2\n                });\n              } else {\n                var _message3 = _typeName3 + \"(\" + _checkedEle.name + _aging2 + \"h)\";\n\n                this.$message.warning(_message3 + \"暂无数据!\");\n              }\n            } else {\n              infoList.push({\n                checked: false,\n                id: _id4\n              });\n            }\n          }\n          break;\n\n        case \"vf\":\n          this.valueFcst.forEach(function (typeItem) {\n            var id = typeItem.id,\n                date = typeItem.date,\n                hour = typeItem.hour,\n                aging = typeItem.aging,\n                typeEleList = typeItem.typeEleList,\n                typeEleId = typeItem.typeEleId;\n            var currType = typeEleList.find(function (el) {\n              return el.id === typeEleId;\n            });\n            var currEle = currType.eleList.find(function (el) {\n              return el.checked;\n            });\n            var manageId = \"vf_\" + id;\n            var typeName = eleOption[manageId].typeName;\n\n            if (currEle) {\n              if (date) {\n                var _latestTime3 = date.format(\"YYYYMMDD\") + hour + \"00\";\n\n                var level = currEle.type === \"无层次\" ? \"\" : currType.level;\n                infoList.push({\n                  id: manageId,\n                  checked: true,\n                  latestTime: _latestTime3,\n                  pathId: currEle.pathId,\n                  aging: aging,\n                  level: level\n                });\n              } else {\n                var _message4 = typeName + \"(\" + currEle.name + aging + \")\";\n\n                _this3.$message.warning(_message4 + \"暂无数据!\");\n              }\n            } else {\n              infoList.push({\n                checked: false,\n                id: manageId\n              });\n            }\n          });\n          break;\n      } // console.log(infoList);\n\n\n      infoList.forEach(function (el) {\n        if (el.checked) {\n          _this3.renderElementData(el);\n        } else {\n          _this3.removeLayersById(el.id);\n        }\n      });\n    },\n    initMap: function initMap() {\n      var _this4 = this;\n\n      this.mapIds.forEach(function (id, i) {\n        _this4[id] = L.map(id, {\n          center: [37.17782559332976, 107.314453125],\n          zoom: 5,\n          minZoom: 4,\n          maxZoom: 13,\n          attributionControl: false,\n          zoomControl: false\n        }); // L.control\n        //   .zoom({\n        //     position: id === \"map2\" || id === \"map4\" ? \"topleft\" : \"topright\"\n        //   })\n        //   .addTo(this[id]);\n\n        _this4[\"mapLayer\" + (i + 1)][\"default\"] = L.tileLayer(eleOption.default.path, {\n          zIndex: 0\n        }).addTo(_this4[id]);\n        _this4[\"mapLayer\" + (i + 1)][\"layer_ele_boundary\"] = L.tileLayer(eleOption.layer_ele_boundary.path, {\n          zIndex: 700\n        }).addTo(_this4[id]);\n        _this4[\"mapLayer\" + (i + 1)][\"layer_ele_point_name\"] = L.tileLayer(eleOption.layer_ele_point_name.path, {\n          zIndex: 700\n        }).addTo(_this4[id]);\n        _this4[\"mapLayer\" + (i + 1)][\"layer_ele_river\"] = L.tileLayer(eleOption.layer_ele_river.path, {\n          zIndex: 700\n        }).addTo(_this4[id]);\n      });\n\n      if (this.isSync) {\n        this.syncMap();\n      }\n    },\n    // 分屏结束时\n    onSplitScreenEnd: function onSplitScreenEnd(event) {\n      if (event.propertyName === \"width\" || event.propertyName === \"height\") {\n        var mapId = event.target.id.split(\"_\")[1]; // console.log(mapId);\n\n        this[mapId]._onResize();\n      }\n    },\n    // 切换分屏\n    onClickSwitchSplitScreen: function onClickSwitchSplitScreen(index) {\n      this.cut_split_screen(index);\n    },\n    // 同步地图操作\n    syncMap: function syncMap() {\n      var _this5 = this;\n\n      var currMap = this[this.currMapId];\n      this.mapIds.forEach(function (id) {\n        _this5[id].off(\"moveend\");\n      });\n      currMap.on(\"moveend\", function (e) {\n        var center = currMap.getCenter();\n        var zoom = currMap.getZoom(); // console.log(center, zoom);\n\n        _this5.mapIds.forEach(function (id) {\n          if (id === _this5.currMapId) return;\n\n          _this5[id].flyTo(center, zoom);\n        });\n      });\n    },\n    // 图层控制器(添加与删除图层)\n    layerController: function layerController(elementInfo) {\n      var checked = elementInfo.checked; // 选中\n\n      if (checked) {\n        // 选中但没有时间\n        if (elementInfo.latestTime === undefined && !elementInfo.time || elementInfo.latestTime === \"\") {\n          this.$message.warning(elementInfo.name + \"暂无数据!\");\n          return;\n        }\n\n        this.requestData(elementInfo);\n        return;\n      } // 未选中\n\n\n      this.removeLayersById(elementInfo.id);\n    },\n    // 请求数据\n    requestData: function requestData(elementInfo) {\n      if (elementInfo.conditionKey === \"currAcc\") {\n        //强天气>累计: 将conditionValue中的值更新到currAcc上\n        elementInfo.currAcc = elementInfo.conditionValue;\n      } else if (elementInfo.conditionKey === \"currObserve\") {\n        //强天气>观测: 将conditionValue中的值更新到currAcc上\n        elementInfo.currObserve = elementInfo.conditionValue;\n      } else if (elementInfo.latestTime === undefined) {\n        //所有: 将时间更新到latestTime\n        elementInfo.latestTime = elementInfo.time;\n      } else if (elementInfo.currAging && elementInfo.latestAging === undefined) {\n        //云图: 将时效更新到latestAging\n        elementInfo.latestAging = elementInfo.currAging;\n      } else if (elementInfo.currThreshold && elementInfo.latestThreshold === undefined) {\n        //自动站: 将阀值更新到latestThreshold\n        elementInfo.latestThreshold = elementInfo.currThreshold;\n      } else if (elementInfo.currLevel && elementInfo.latestLevel === undefined) {\n        //SWAN拼图: 层次更新\n        elementInfo.latestLevel = elementInfo.currLevel;\n      }\n\n      this.renderElementData(elementInfo);\n    },\n    // 单站pup:图层控制器(添加与删除图层)\n    layerController_stationPup: function layerController_stationPup() {\n      // console.log(this.stationPup);\n      var _this$stationPup = this.stationPup,\n          moduleId = _this$stationPup.moduleId,\n          currEleTime = _this$stationPup.currEleTime,\n          currEleId = _this$stationPup.currEleId,\n          currStationId = _this$stationPup.currStationId;\n      var elementInfo = {\n        id: moduleId,\n        latestTime: currEleTime,\n        currEleId: currEleId,\n        currStationId: currStationId\n      };\n\n      if (currEleTime) {\n        if (currEleId) {\n          this.renderElementData(elementInfo);\n        } else {\n          this.removeLayersById(elementInfo.id);\n        }\n      } else {\n        this.$message.warning(\"单站pup暂无数据!\");\n      }\n    },\n    // 基础图层切换\n    renderBaseLayer: function renderBaseLayer() {\n      var _this6 = this;\n\n      var currBaseLayerId = this.currSplitScreen.currBaseLayerId;\n      var baseLayerList = this.currSplitScreen.baseLayerList;\n      var currEleOption = eleOption[currBaseLayerId];\n      this.tileLayerRender(currEleOption.id, currEleOption.path);\n      baseLayerList.forEach(function (el) {\n        if (el.id === currBaseLayerId || el.id === \"default\") return;\n\n        _this6.removeLayer(el.id);\n      });\n      this.select_all_layer_element(currBaseLayerId !== \"xingzheng\");\n      this.currSplitScreen.layerElementList.forEach(function (item) {\n        var currEleOption = eleOption[item.id];\n\n        _this6.removeLayer(item.id);\n\n        if (item.checked) {\n          _this6.tileLayerRender(currEleOption.id, currEleOption.path, 700);\n        }\n      });\n    },\n    // 基础图层要素切换(边界线，行政点名称，河流等)\n    onClickSelectLayerElement: function onClickSelectLayerElement(item) {\n      this.select_layer_element(item.id);\n      var currEleOption = eleOption[item.id];\n      this.removeLayer(item.id);\n\n      if (item.checked) {\n        this.tileLayerRender(currEleOption.id, currEleOption.path, 700);\n      }\n    },\n    // 渲染要素数据\n    renderElementData: function renderElementData(elementInfo) {\n      var path = eleOption.getPath(elementInfo);\n      var currEleOption = eleOption[elementInfo.id];\n      var dataType = currEleOption.dataType; // console.log(dataType);\n\n      switch (dataType) {\n        case \"tile\":\n          this.tileLayerRender(currEleOption.id, path);\n          break;\n\n        case \"imageOverlay\":\n          this.imageOverlayLayerRender(currEleOption.id, path);\n          break;\n\n        case \"text\":\n          this.textLayerRender(currEleOption.id, path);\n          break;\n\n        case \"dat\":\n          this.datLayerRender(currEleOption.id, path);\n          break;\n\n        case \"plot10min\":\n          this.plot10minLayerRender(elementInfo, path);\n          break;\n\n        case \"PupMosaicJson58\":\n          this.pupMosaicJson58LayerRender(elementInfo, path);\n          break;\n\n        case \"PupMosaicJson59\":\n          this.pupMosaicJson59LayerRender(elementInfo, path);\n          break;\n\n        case \"PupMosaicJson60\":\n          this.pupMosaicJson60LayerRender(elementInfo, path);\n          break;\n\n        case \"PupMosaicJson61\":\n          this.pupMosaicJson61LayerRender(elementInfo, path);\n          break;\n\n        case \"PupMosaicJson62\":\n          this.pupMosaicJson62LayerRender(elementInfo, path);\n          break;\n      }\n    },\n    // 添加tile图层\n    tileLayerRender: function tileLayerRender(id, path, zIndex) {\n      zIndex = zIndex === undefined ? eleOption[id].zIndex : zIndex;\n\n      if (!this.currMapLayer[id]) {}\n\n      var layer = L.tileLayer(path, {\n        zIndex: zIndex\n      });\n      this.storeLayersById(id, layer);\n      this.removeLayer(id);\n      this.currMapLayer[id] = layer;\n      this.addLayer(id, layer); // console.log(this.currMapLayer);\n      // console.log(layer);\n    },\n    // 添加imageOverlay图层\n    imageOverlayLayerRender: function imageOverlayLayerRender(id, path) {\n      var _this7 = this;\n\n      var _eleOption$id = eleOption[id],\n          place = _eleOption$id.place,\n          zIndex = _eleOption$id.zIndex;\n\n      var renderImage = function renderImage(place) {\n        var imageBounds = L.latLngBounds(L.latLng(place.south, place.west), L.latLng(place.north, place.east));\n        var layer = L.imageOverlay(path, imageBounds, {\n          pane: \"tilePane\",\n          zIndex: zIndex\n        });\n\n        _this7.storeLayersById(id, layer);\n\n        layer.on(\"load\", function () {\n          _this7.removeLayer(id);\n\n          _this7.currMapLayer[id] = layer;\n        });\n        layer.on(\"error\", function () {\n          _this7.removeLayer(id);\n\n          _this7.currMapLayer[id] = layer;\n        });\n\n        _this7.addLayer(id, layer);\n      };\n\n      if (place) {\n        renderImage(place);\n        return;\n      }\n\n      var CancelToken = axios.CancelToken;\n      this.cancelRequest(id);\n      axios.get(path + \".json\", {\n        cancelToken: new CancelToken(function (c) {\n          var tokenList = _this7.currMapLayer[id + \"_token\"];\n\n          if (!tokenList) {\n            tokenList = _this7.currMapLayer[id + \"_token\"] = [];\n          }\n\n          tokenList.push(c);\n        })\n      }).then(function (data) {\n        var place = data.data;\n        renderImage(place);\n      });\n    },\n    // 添加text图层\n    textLayerRender: function textLayerRender(id, path) {\n      var _this8 = this;\n\n      var CancelToken = axios.CancelToken;\n      this.cancelRequest(id);\n      axios.get(path, {\n        cancelToken: new CancelToken(function (c) {\n          var tokenList = _this8.currMapLayer[id + \"_token\"];\n\n          if (!tokenList) {\n            tokenList = _this8.currMapLayer[id + \"_token\"] = [];\n          }\n\n          tokenList.push(c);\n        })\n      }).then(function (data) {\n        _this8.removeLayer(id);\n\n        var layer = L.RH.lightningLayer({});\n        layer.parseM4Data(data.data); // layer.addTo(this.currMap);\n\n        _this8.storeLayersById(id, layer);\n\n        _this8.currMapLayer[id] = layer;\n\n        _this8.addLayer(id, layer);\n      });\n    },\n    // 添加dat图层\n    datLayerRender: function datLayerRender(id, path) {\n      var _this9 = this;\n\n      var CancelToken = axios.CancelToken;\n      this.cancelRequest(id);\n      axios.get(path, {\n        cancelToken: new CancelToken(function (c) {\n          var tokenList = _this9.currMapLayer[id + \"_token\"];\n\n          if (!tokenList) {\n            tokenList = _this9.currMapLayer[id + \"_token\"] = [];\n          }\n\n          tokenList.push(c);\n        })\n      }).then(function (data) {\n        var gridData = parseM4Data(data.data);\n        var currEleOption = eleOption[id];\n        var clevels = currEleOption.clevels,\n            ccolors = currEleOption.ccolors;\n\n        _this9.gridDataToShade(id, gridData, clevels, ccolors);\n      });\n    },\n    gridDataToShade: function gridDataToShade(id, GridData, clevels, ccolors) {\n      var n = GridData.lonCount,\n          m = GridData.latCount,\n          lonstart = GridData.startLon,\n          latstart = GridData.startLat,\n          longap = GridData.lonStep,\n          latgap = GridData.latStep,\n          values = [];\n      var min = null;\n      var max = null;\n\n      for (var i = 0; i < GridData.DS.length; i++) {\n        var v = GridData.DS[i];\n\n        if (v === 9999 || v === 9999.0) {\n          v = null;\n        }\n\n        if (min === null || v !== null && v < min) {\n          min = v;\n        }\n\n        if (max === null || v !== null && v > max) {\n          max = v;\n        }\n\n        values.push(v === null ? -9999 : v);\n      }\n\n      if (clevels.length * 4 != ccolors.length) {\n        throw new Error(\"ccolors length is not equal to clevels x 4\");\n      }\n\n      var colorMap = {};\n\n      for (var i = 0; i < clevels.length; i++) {\n        var val = clevels[i];\n        colorMap[\"\" + val] = [ccolors[i * 4], ccolors[i * 4 + 1], ccolors[i * 4 + 2], ccolors[i * 4 + 3]];\n      }\n\n      var thresholds = clevels;\n      var contours = d3Contour.contours().size([n, m]).smooth(true).thresholds(thresholds)(values);\n\n      for (var s = 0; s < contours.length; s++) {\n        var d = contours[s];\n\n        for (var i = 0; i < d.coordinates.length; i++) {\n          for (var k = 0; k < d.coordinates[i].length; k++) {\n            for (var j = 0; j < d.coordinates[i][k].length; j++) {\n              var entity = d.coordinates[i][k][j];\n              var a0 = entity[0];\n              var a1 = entity[1];\n              entity[0] = lonstart + a0 * longap;\n              entity[1] = latstart + a1 * latgap;\n            }\n          }\n        }\n      }\n\n      var geoJson = {\n        type: \"FeatureCollection\",\n        features: contours\n      };\n      var layer = L.geoJSON(geoJson, {\n        pane: \"tilePane\",\n        style: function style(feature) {\n          var v = feature.geometry.value;\n          var cor = colorMap[\"\" + v];\n          return {\n            weight: 0,\n            fillOpacity: cor[3] / 255,\n            color: \"rgb(\" + cor[0] + \",\" + cor[1] + \",\" + cor[2] + \")\"\n          };\n        }\n      });\n      this.removeLayer(id); // layer.addTo(this.currMap);\n\n      this.storeLayersById(id, layer);\n      this.addLayer(id, layer);\n    },\n    // 添加plot10min图层\n    plot10minLayerRender: function plot10minLayerRender(elementInfo, path) {\n      var _this10 = this;\n\n      var CancelToken = axios.CancelToken;\n      this.cancelRequest(elementInfo.id);\n      axios.get(path, {\n        cancelToken: new CancelToken(function (c) {\n          var tokenList = _this10.currMapLayer[elementInfo.id + \"_token\"];\n\n          if (!tokenList) {\n            tokenList = _this10.currMapLayer[elementInfo.id + \"_token\"] = [];\n          }\n\n          tokenList.push(c);\n        })\n      }).then(function (data) {\n        data = data.data;\n\n        if (data != null) {\n          //判断是否有数据\n          if (data.substring && data.substring(1, 4) == \"PNG\") {// getErrorPrompt(\"自动站降水,\" + time);\n          }\n\n          var datas = [];\n\n          for (var i = 0; i < data.features.length; i++) {\n            var feature = data.features[i].geometry;\n            feature.type = _this10.capitalizeFirstLetter(feature.type);\n            datas.push({\n              latlng: feature.coordinates,\n              properties: data.features[i].properties\n            });\n          }\n\n          if (elementInfo.name === \"极大风\") {\n            _this10.zdzWindRender(elementInfo, datas);\n          } else {\n            _this10.zdzCommonRender(elementInfo, datas);\n          }\n        }\n      });\n    },\n    capitalizeFirstLetter: function capitalizeFirstLetter(string) {\n      return string.charAt(0).toUpperCase() + string.slice(1);\n    },\n    // 自动站报警--wind\n    zdzWindRender: function zdzWindRender(elementInfo, datas) {\n      var _this11 = this;\n\n      var threshold = elementInfo.latestThreshold;\n      var zdzDatas = [];\n\n      for (var i = 0; i < datas.length; i++) {\n        var item = datas[i];\n        var _item$properties = item.properties,\n            ID = _item$properties.ID,\n            WS = _item$properties.WS,\n            WD = _item$properties.WD,\n            T = _item$properties.T,\n            R = _item$properties.R,\n            MaxWind_Time = _item$properties.MaxWind_Time;\n\n        if (WS != 9999 && WD != 9999) {\n          if (WS >= threshold) {\n            zdzDatas.push({\n              stationId: ID,\n              stationName: \"\",\n              lng: item.latlng[0],\n              lat: item.latlng[1],\n              datas: [WS, null, null, null],\n              datasVisibilityMask: [true, false, false, false],\n              showAnyway: true,\n              windSD: {\n                speed: WS,\n                dir: WD\n              },\n              stationImageUrl: null,\n              properties: {\n                ID: ID,\n                WS: WS,\n                WD: WD,\n                T: T,\n                R: R,\n                MaxWind_Time: MaxWind_Time\n              },\n              vaneColorFn: function vaneColorFn(speed, direcation) {\n                var ret = \"black\";\n\n                if (speed >= 17 && speed < 25) {\n                  ret = \"#F0F\";\n                } else if (speed >= 25 && speed < 30) {\n                  ret = \"#FF6600\";\n                } else if (speed >= 30) {\n                  ret = \"#211551\";\n                }\n\n                return ret;\n              }\n            });\n          }\n        }\n      }\n\n      var windLayer = L.RH.zdzLayer({\n        clickHandler: function clickHandler(item) {\n          if (_this11._popup) {\n            _this11._popup.remove();\n\n            _this11._popup = null;\n          }\n\n          setTimeout(function () {\n            _this11._popup = L.popup({\n              maxWidth: 500\n            }).setLatLng(L.latLng(item.lat, item.lng)).setContent('<div class=\"my-marker-cluster-popup\">xxxxx</div>').openOn(_this11.currMap);\n            console.log(_this11._popup);\n\n            _this11.getZdzInfo(_this11._popup, _objectSpread({}, item.properties, {\n              id: item.stationId\n            }));\n          });\n        }\n      });\n      windLayer.setData(zdzDatas);\n      this.removeLayer(elementInfo.id);\n      this.currMapLayer[elementInfo.id] = windLayer;\n      this.storeLayersById(id, windLayer);\n      var isHideLayer = this.showHideLayerHash[elementInfo.id].isHideLayer;\n\n      if (!isHideLayer) {\n        this.currMap.addLayer(windLayer);\n      }\n    },\n    // 自动站报警-rain,temp\n    zdzCommonRender: function zdzCommonRender(elementInfo, datas) {\n      var _this12 = this;\n\n      var eleNameHash = {\n        降水: \"R\",\n        // \"极大风\": \"WS\",\n        \"温度>\": \"T\",\n        \"温度<\": \"T\"\n      };\n      var eleKey = eleNameHash[elementInfo.name];\n      var threshold = elementInfo.latestThreshold;\n      var markers = L.markerClusterGroup({\n        showCoverageOnHover: false,\n        maxClusterRadius: 50,\n        iconCreateFunction: function iconCreateFunction(cluster) {\n          var markers = cluster.getAllChildMarkers();\n          var extMarker = markers.slice().sort(function (a, b) {\n            if (elementInfo.name === \"温度<\") {\n              return a._myData.currData - b._myData.currData;\n            }\n\n            return b._myData.currData - a._myData.currData;\n          })[0];\n          var _extMarker$_myData = extMarker._myData,\n              id = _extMarker$_myData.id,\n              currData = _extMarker$_myData.currData;\n          var isWarning = false;\n\n          if (elementInfo.name === \"温度<\") {\n            isWarning = currData <= threshold;\n          } else {\n            isWarning = currData >= threshold;\n          }\n\n          var icon = new L.DivIcon({\n            className: \"my-marker-cluster\" + (isWarning ? \" my-marker-ani\" : \"\"),\n            html: \"<div>\".concat(currData, \"</div>\"),\n            iconSize: new L.Point(40, 40)\n          });\n          return icon;\n        }\n      });\n      datas.forEach(function (item, i) {\n        var props = item.properties;\n        var id = props[\"ID\"];\n        var currData = props[eleKey];\n        if (currData === undefined || currData == 9999) return;\n        var isWarning = false;\n\n        if (elementInfo.name === \"温度<\") {\n          isWarning = currData <= threshold;\n        } else {\n          isWarning = currData >= threshold;\n        }\n\n        var myIcon = L.divIcon({\n          className: \"my-marker-cluster-marker\" + (isWarning ? \" my-marker-ani\" : \"\"),\n          html: \"<div>\".concat(currData, \"</div>\")\n        });\n        var marker = L.marker(new L.LatLng(item.latlng[1], item.latlng[0]), {\n          icon: myIcon\n        });\n        marker._myData = {\n          id: id,\n          currData: currData\n        };\n        marker.bindPopup('<div class=\"my-marker-cluster-popup\"></div>', {\n          maxWidth: 500\n        });\n        marker.on(\"click\", function () {\n          _this12.getZdzInfo(marker, _objectSpread({}, props, {\n            id: id\n          }), false);\n        });\n        markers.addLayer(marker);\n      });\n      this.removeLayer(elementInfo.id);\n      this.currMapLayer[elementInfo.id] = markers;\n      this.storeLayersById(id, markers);\n      var isHideLayer = this.showHideLayerHash[elementInfo.id].isHideLayer;\n\n      if (!isHideLayer) {\n        this.currMap.addLayer(markers);\n      }\n    },\n    getZdzInfo: function getZdzInfo(obj, props) {\n      var isPopup = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n      var params = new URLSearchParams();\n      params.append(\"stationId\", this.getStationId(props.id));\n      axios.post(\"/proxy/10.20.67.111/stweather/StationDataInfoServlet\", params).then(function (data) {\n        var name = data.data;\n        obj[isPopup ? \"setContent\" : \"setPopupContent\"](\"<div class=\\\"my-marker-cluster-popup\\\">\\n            <ul>\\n              <li>\\n                <div>\\n                  <span>\\u7AD9\\u53F7:</span>\\n                  <span>\".concat(props.id, \"</span>\\n                </div>\\n                <div>\\n                  <span>\\u7AD9\\u540D:</span>\\n                  <span>\").concat(name, \"</span>\\n                </div>\\n              </li>\\n              <li>\\n                <div>\\n                  <span>\\u964D\\u6C34:</span>\\n                  <span>\").concat(props.R === undefined ? \"\" : props.R, \"mm</span>\\n                </div>\\n                <div>\\n                  <span>\\u6E29\\u5EA6:</span>\\n                  <span>\").concat(props.T === undefined ? \"\" : props.T, \"\\u2103</span>\\n                </div>\\n              </li>\\n              <li>\\n                <div>\\n                  <span>\\u98CE\\u529B:</span>\\n                  <span>\").concat(props.WS === undefined ? \"\" : props.WS, \"m/s</span>\\n                </div>\\n                <div>\\n                  <span>\\u98CE\\u5411:</span>\\n                  <span>\").concat(props.WD === undefined ? \"\" : props.WD, \"</span>\\n                </div>\\n              </li>\\n              <li>\\n                <div>\\n                  <span>\\u6781\\u5927\\u98CE\\u51FA\\u73B0\\u65F6\\u95F4:</span>\\n                  <span>\").concat(props.MaxWind_Time === undefined ? \"\" : props.MaxWind_Time, \"</span>\\n                </div>\\n              </li>\\n            </ul>\\n            </div>\"));\n      });\n    },\n    getStationId: function getStationId(id) {\n      id = id + \"\";\n      return String.fromCharCode(id.slice(0, 2)) + id.slice(2);\n    },\n    pupMosaicJson58LayerRender: function pupMosaicJson58LayerRender(elementInfo, path) {\n      var _this13 = this;\n\n      var CancelToken = axios.CancelToken;\n      this.cancelRequest(elementInfo.id);\n      axios.get(path, {\n        cancelToken: new CancelToken(function (c) {\n          var tokenList = _this13.currMapLayer[elementInfo.id + \"_token\"];\n\n          if (!tokenList) {\n            tokenList = _this13.currMapLayer[elementInfo.id + \"_token\"] = [];\n          }\n\n          tokenList.push(c);\n        })\n      }).then(function (data) {\n        var dataList = data.data.features;\n        console.log(dataList);\n        var markers = L.markerClusterGroup({\n          showCoverageOnHover: false,\n          maxClusterRadius: 50,\n          iconCreateFunction: function iconCreateFunction(cluster) {\n            var icon = new L.DivIcon({\n              className: \"my-marker-cluster-yellow icon-fbzz my-marker-ani\",\n              html: '',\n              iconSize: new L.Point(40, 40)\n            });\n            return icon;\n          }\n        });\n        dataList.forEach(function (item, i) {\n          var props = item.properties;\n          var myIcon = L.divIcon({\n            className: \"my-marker-yellow icon-fbzz my-marker-ani\",\n            html: \"<div>\".concat(props.id, \"</div>\")\n          });\n          var marker = L.marker(new L.LatLng(props.lat, props.lon), {\n            icon: myIcon\n          });\n          marker.bindPopup('<div class=\"my-marker-cluster-popup\">xxxxxx</div>', {\n            maxWidth: 500\n          });\n          markers.addLayer(marker);\n        });\n\n        _this13.removeLayer(elementInfo.id);\n\n        _this13.currMapLayer[elementInfo.id] = markers;\n\n        _this13.storeLayersById(elementInfo.id, markers);\n\n        var isHideLayer = _this13.showHideLayerHash[elementInfo.id].isHideLayer;\n\n        if (!isHideLayer) {\n          _this13.currMap.addLayer(markers);\n        }\n      });\n    },\n    pupMosaicJson59LayerRender: function pupMosaicJson59LayerRender(elementInfo, path) {\n      var _this14 = this;\n\n      var CancelToken = axios.CancelToken;\n      this.cancelRequest(elementInfo.id);\n      axios.get(path, {\n        cancelToken: new CancelToken(function (c) {\n          var tokenList = _this14.currMapLayer[elementInfo.id + \"_token\"];\n\n          if (!tokenList) {\n            tokenList = _this14.currMapLayer[elementInfo.id + \"_token\"] = [];\n          }\n\n          tokenList.push(c);\n        })\n      }).then(function (data) {\n        var dataList = data.data.features;\n        console.log(dataList);\n        var markers = L.markerClusterGroup({\n          showCoverageOnHover: false,\n          maxClusterRadius: 50,\n          iconCreateFunction: function iconCreateFunction(cluster) {\n            var icon = new L.DivIcon({\n              className: \"my-marker-cluster-yellow icon-bbzs my-marker-ani\",\n              html: '',\n              iconSize: new L.Point(40, 40)\n            });\n            return icon;\n          }\n        });\n        dataList.forEach(function (item, i) {\n          var props = item.properties;\n          var myIcon = L.divIcon({\n            className: \"my-marker-yellow icon-bbzs my-marker-ani\",\n            html: \"\",\n            iconSize: new L.Point(40, 40)\n          });\n          var marker = L.marker(new L.LatLng(props.lat, props.lon), {\n            icon: myIcon\n          });\n          marker.bindPopup('<div class=\"my-marker-cluster-popup\">xxxxxx</div>', {\n            maxWidth: 500\n          });\n          markers.addLayer(marker);\n        });\n\n        _this14.removeLayer(elementInfo.id);\n\n        _this14.currMapLayer[elementInfo.id] = markers;\n\n        _this14.storeLayersById(elementInfo.id, markers);\n\n        var isHideLayer = _this14.showHideLayerHash[elementInfo.id].isHideLayer;\n\n        if (!isHideLayer) {\n          _this14.currMap.addLayer(markers);\n        }\n      });\n    },\n    pupMosaicJson60LayerRender: function pupMosaicJson60LayerRender(elementInfo, path) {\n      var _this15 = this;\n\n      var CancelToken = axios.CancelToken;\n      this.cancelRequest(elementInfo.id);\n      axios.get(path, {\n        cancelToken: new CancelToken(function (c) {\n          var tokenList = _this15.currMapLayer[elementInfo.id + \"_token\"];\n\n          if (!tokenList) {\n            tokenList = _this15.currMapLayer[elementInfo.id + \"_token\"] = [];\n          }\n\n          tokenList.push(c);\n        })\n      }).then(function (data) {\n        var dataList = data.data.features;\n        console.log(dataList);\n      });\n    },\n    pupMosaicJson61LayerRender: function pupMosaicJson61LayerRender(elementInfo, path) {\n      var _this16 = this;\n\n      var CancelToken = axios.CancelToken;\n      this.cancelRequest(elementInfo.id);\n      axios.get(path, {\n        cancelToken: new CancelToken(function (c) {\n          var tokenList = _this16.currMapLayer[elementInfo.id + \"_token\"];\n\n          if (!tokenList) {\n            tokenList = _this16.currMapLayer[elementInfo.id + \"_token\"] = [];\n          }\n\n          tokenList.push(c);\n        })\n      }).then(function (data) {\n        var dataList = data.data.features;\n        console.log(dataList);\n      });\n    },\n    pupMosaicJson62LayerRender: function pupMosaicJson62LayerRender(elementInfo, path) {\n      var _this17 = this;\n\n      var CancelToken = axios.CancelToken;\n      this.cancelRequest(elementInfo.id);\n      axios.get(path, {\n        cancelToken: new CancelToken(function (c) {\n          var tokenList = _this17.currMapLayer[elementInfo.id + \"_token\"];\n\n          if (!tokenList) {\n            tokenList = _this17.currMapLayer[elementInfo.id + \"_token\"] = [];\n          }\n\n          tokenList.push(c);\n        })\n      }).then(function (data) {\n        var dataList = data.data.features;\n        console.log(dataList);\n      });\n    },\n    // 存储指定要素下所有加载的图层\n    storeLayersById: function storeLayersById(id, layer) {\n      id = \"all_layer_\" + id;\n      var layers = this.currMapLayer[id];\n\n      if (!_Array$isArray(layers)) {\n        layers = this.currMapLayer[id] = [];\n      }\n\n      layers.push(layer);\n    },\n    // 添加图层\n    addLayer: function addLayer(id, layer) {\n      var isShowLayer;\n\n      if (this.showHideLayerHash[id] === undefined) {\n        isShowLayer = true;\n      } else {\n        isShowLayer = !this.showHideLayerHash[id].isHideLayer;\n      }\n\n      if (isShowLayer) {\n        layer.addTo(this.currMap);\n      }\n    },\n    // 删除指定要素下所有加载的图层\n    removeLayersById: function removeLayersById(id) {\n      id = \"all_layer_\" + id;\n      var layers = this.currMapLayer[id];\n\n      if (_Array$isArray(layers)) {\n        layers.forEach(function (lr) {\n          return lr.remove();\n        });\n        this.currMapLayer[id] = [];\n      }\n    },\n    // 删除图层\n    removeLayer: function removeLayer(id) {\n      var layer = this.currMapLayer[id];\n\n      if (layer) {\n        layer.remove();\n        this.currMapLayer[id] = null;\n      }\n    },\n    // 取消请求\n    cancelRequest: function cancelRequest(id) {\n      var tokenList = this.currMapLayer[id + \"_token\"];\n\n      if (tokenList && _Array$isArray(tokenList)) {\n        tokenList.forEach(function (c) {\n          return c();\n        });\n        this.currMapLayer[id + \"_token\"] = null;\n      }\n    },\n    // 格式化时效\n    formatAging: function formatAging(aging) {\n      var leng = (\"\" + aging).length;\n\n      if (leng === 1) {\n        aging = \"00\" + aging;\n      } else if (leng === 2) {\n        aging = \"0\" + aging;\n      }\n\n      return aging;\n    }\n  })\n};",{"version":3,"sources":["D:\\program\\frontend\\src\\views\\synthesis\\maps\\Maps.js"],"names":["moment","L","_","axios","createNamespacedHelpers","mapState","mapGetters","mapMutations","eleOption","name","components","props","elementInfo","type","Object","data","isShowBaseLayerPanel","isVoice","isSync","isFullScreenshot","isAreaScreenshot","splitScreenNumber","mapIds","mapLayer1","mapLayer2","mapLayer3","mapLayer4","computed","currMapId","ssIndex","currMapLayer","currMap","watch","syncMap","forEach","id","off","showHideLayerHash","hash","oldHash","key","newVal","oldVal","undefined","layer","remove","addTo","created","debouncedLc","debounce","layerController","debouncedLcSationPup","layerController_stationPup","mounted","$message","config","top","duration","initMap","cancelSubscribe","$store","subscribe","mutation","state","fcstWarnAndValueFcstInfo","renderBaseLayer","checkedHourEleList","station","hourEleList","filter","el","checked","eleInfo","cloneDeep","currHour","payload","updateElementInfo","checkedHourEleList1","severeWeather","conditionKey","eleInfo1","eleInfo2","eleInfo3","beforeDestroy","methods","typeName","infoList","fcstWarning","shortTerm","date","hour","aging","formatAging","fw_short_term","latestTime","format","push","message","warning","shortTime","eleList","fw_short_time","checkedEle","find","pathId","stateWarn","fw_warn_state","provinceWarn","minute","fw_warn_province","valueFcst","typeItem","typeEleList","typeEleId","currType","currEle","manageId","level","renderElementData","removeLayersById","i","map","center","zoom","minZoom","maxZoom","attributionControl","zoomControl","tileLayer","default","path","zIndex","layer_ele_boundary","layer_ele_point_name","layer_ele_river","onSplitScreenEnd","event","propertyName","mapId","target","split","_onResize","onClickSwitchSplitScreen","index","cut_split_screen","on","e","getCenter","getZoom","flyTo","time","requestData","currAcc","conditionValue","currObserve","currAging","latestAging","currThreshold","latestThreshold","currLevel","latestLevel","stationPup","moduleId","currEleTime","currEleId","currStationId","currBaseLayerId","currSplitScreen","baseLayerList","currEleOption","tileLayerRender","removeLayer","select_all_layer_element","layerElementList","item","onClickSelectLayerElement","select_layer_element","getPath","dataType","imageOverlayLayerRender","textLayerRender","datLayerRender","plot10minLayerRender","pupMosaicJson58LayerRender","pupMosaicJson59LayerRender","pupMosaicJson60LayerRender","pupMosaicJson61LayerRender","pupMosaicJson62LayerRender","storeLayersById","addLayer","place","renderImage","imageBounds","latLngBounds","latLng","south","west","north","east","imageOverlay","pane","CancelToken","cancelRequest","get","cancelToken","c","tokenList","then","RH","lightningLayer","parseM4Data","gridData","clevels","ccolors","gridDataToShade","GridData","n","lonCount","m","latCount","lonstart","startLon","latstart","startLat","longap","lonStep","latgap","latStep","values","min","max","DS","length","v","Error","colorMap","val","thresholds","contours","d3Contour","size","smooth","s","d","coordinates","k","j","entity","a0","a1","geoJson","features","geoJSON","style","feature","geometry","value","cor","weight","fillOpacity","color","substring","datas","capitalizeFirstLetter","latlng","properties","zdzWindRender","zdzCommonRender","string","charAt","toUpperCase","slice","threshold","zdzDatas","ID","WS","WD","T","R","MaxWind_Time","stationId","stationName","lng","lat","datasVisibilityMask","showAnyway","windSD","speed","dir","stationImageUrl","vaneColorFn","direcation","ret","windLayer","zdzLayer","clickHandler","_popup","setTimeout","popup","maxWidth","setLatLng","setContent","openOn","console","log","getZdzInfo","setData","isHideLayer","eleNameHash","降水","eleKey","markers","markerClusterGroup","showCoverageOnHover","maxClusterRadius","iconCreateFunction","cluster","getAllChildMarkers","extMarker","sort","a","b","_myData","currData","isWarning","icon","DivIcon","className","html","iconSize","Point","myIcon","divIcon","marker","LatLng","bindPopup","obj","isPopup","params","URLSearchParams","append","getStationId","post","String","fromCharCode","dataList","lon","layers","isShowLayer","lr","leng"],"mappings":"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","sourcesContent":["import * as moment from \"moment\";\r\nimport L from \"leaflet\";\r\nimport _ from \"lodash\";\r\nimport * as axios from \"axios\";\r\nimport { createNamespacedHelpers } from \"vuex\";\r\nconst { mapState, mapGetters, mapMutations } = createNamespacedHelpers(\r\n  \"synthesis\"\r\n);\r\nimport eleOption from \"../element-option\";\r\nimport \"../../../assets/js/leaflet-rh\";\r\nimport \"../../../assets/js/leaflet-markercluster/leaflet.markercluster\";\r\n\r\n// import * as d3 from 'd3';\r\n// import * as d3Contour from 'd3-contour';\r\n// console.log(d3);\r\n\r\nexport default {\r\n  name: \"maps\",\r\n  components: {},\r\n  props: {\r\n    elementInfo: {\r\n      type: Object\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      isShowBaseLayerPanel: false,\r\n      isVoice: true,\r\n      isSync: true,\r\n      isFullScreenshot: false,\r\n      isAreaScreenshot: false,\r\n      splitScreenNumber: 1, //当前分屏数，1：1分屏，2：2分屏， 4：4分屏\r\n      mapIds: [\"map1\", \"map2\", \"map3\", \"map4\"],\r\n      mapLayer1: {},\r\n      mapLayer2: {},\r\n      mapLayer3: {},\r\n      mapLayer4: {}\r\n    };\r\n  },\r\n  computed: {\r\n    ...mapState([\"ssIndex\"]),\r\n    ...mapGetters([\r\n      \"currSplitScreen\",\r\n      \"showHideLayerHash\",\r\n      \"stationPup\",\r\n      \"station\",\r\n      \"severeWeather\",\r\n      \"fcstWarning\",\r\n      \"valueFcst\"\r\n    ]),\r\n    currMapId() {\r\n      return \"map\" + this.ssIndex;\r\n    },\r\n    currMapLayer() {\r\n      return this[\"mapLayer\" + this.ssIndex];\r\n    },\r\n    currMap() {\r\n      return this[\"map\" + this.ssIndex];\r\n    }\r\n  },\r\n  watch: {\r\n    currMapId() {\r\n      if (this.isSync) {\r\n        this.syncMap();\r\n      }\r\n    },\r\n    isSync(isSync) {\r\n      if (isSync) {\r\n        this.syncMap();\r\n      } else {\r\n        this.mapIds.forEach(id => {\r\n          this[id].off(\"moveend\");\r\n        });\r\n      }\r\n    },\r\n\r\n    // 图层的显示隐藏\r\n    showHideLayerHash(hash, oldHash) {\r\n      for (const key in hash) {\r\n        const newVal = hash[key];\r\n        const oldVal = oldHash[key];\r\n        if (oldVal !== undefined && newVal !== oldVal) {\r\n          // console.log(hash, oldHash);\r\n          const layer = this.currMapLayer[key];\r\n          if (layer) {\r\n            if (newVal) {\r\n              layer.remove();\r\n            } else {\r\n              layer.addTo(this.currMap);\r\n            }\r\n            // console.log(layer);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    this.debouncedLc = _.debounce(this.layerController, 300);\r\n    this.debouncedLcSationPup = _.debounce(\r\n      this.layerController_stationPup,\r\n      300\r\n    );\r\n  },\r\n  mounted() {\r\n    this.$message.config({ top: \"100px\", duration: 1 });\r\n    this.initMap();\r\n\r\n    // 订阅store中的mutations(只需要其中的一部分)\r\n    this.cancelSubscribe = this.$store.subscribe((mutation, state) => {\r\n      switch (mutation.type) {\r\n        case \"synthesis/fw_update_short_term_time\":\r\n        case \"synthesis/fw_update_short_term\":\r\n          //预报预警_短期预报\r\n          this.fcstWarnAndValueFcstInfo(\"fw_short_term\");\r\n          break;\r\n        case \"synthesis/fw_update_short_time_time\":\r\n        case \"synthesis/fw_update_short_time\":\r\n          //预报预警_短时预报\r\n          this.fcstWarnAndValueFcstInfo(\"fw_short_time\");\r\n          break;\r\n        case \"synthesis/fw_update_warn_state_time\":\r\n        case \"synthesis/fw_update_warn_state\":\r\n          // 预报预警_国家预警\r\n          this.fcstWarnAndValueFcstInfo(\"fw_warn_state\");\r\n          break;\r\n        case \"synthesis/fw_update_warn_province_time\":\r\n        case \"synthesis/fw_update_warn_province\":\r\n          // 预报预警_省级预警\r\n          this.fcstWarnAndValueFcstInfo(\"fw_warn_province\");\r\n          break;\r\n        case \"synthesis/vf_update_time\":\r\n        case \"synthesis/vf_update\":\r\n          this.fcstWarnAndValueFcstInfo(\"vf\");\r\n          // 数值预报\r\n          break;\r\n\r\n        case \"synthesis/select_base_layer\":\r\n          this.renderBaseLayer();\r\n          break;\r\n        case \"synthesis/st_update_hour\":\r\n          // 自动站:小时选择\r\n          const checkedHourEleList = this.station.hourEleList.filter(\r\n            el => el.checked\r\n          );\r\n          checkedHourEleList.forEach(el => {\r\n            const eleInfo = Object.assign(_.cloneDeep(el), {\r\n              currHour: mutation.payload\r\n            });\r\n            this.updateElementInfo(\"normal\", eleInfo);\r\n          });\r\n          break;\r\n        case \"synthesis/sw_update_hour\":\r\n          // 强天气:小时选择\r\n          const checkedHourEleList1 = this.severeWeather.hourEleList.filter(\r\n            el => el.checked\r\n          );\r\n          checkedHourEleList1.forEach(el => {\r\n            const eleInfo = Object.assign(_.cloneDeep(el), {\r\n              currHour: mutation.payload\r\n            });\r\n            this.updateElementInfo(\"normal\", eleInfo);\r\n          });\r\n          break;\r\n        case \"synthesis/sw_update_element_condition\":\r\n          // 强天气:观测\r\n          if (mutation.payload.conditionKey === \"currObserve\") {\r\n            const eleInfo1 = _.cloneDeep(mutation.payload);\r\n            this.updateElementInfo(\"normal\", eleInfo1);\r\n          }\r\n          break;\r\n        case \"synthesis/update_element_time\":\r\n          // 所有:更新数据时间\r\n          const eleInfo2 = Object.assign(_.cloneDeep(mutation.payload), {\r\n            currHour: this.severeWeather.currHour\r\n          });\r\n          this.updateElementInfo(\"normal\", eleInfo2);\r\n          break;\r\n        case \"synthesis/sn_level_change\":\r\n        // SWAN拼图_层次更新\r\n        case \"synthesis/sn_aging_change\":\r\n        // SWAN拼图_时效更新\r\n        case \"synthesis/st_threshold_change\":\r\n        // 自动站: 阀值更新\r\n        case \"synthesis/cp_aging_change\":\r\n          //云图: 更新时效\r\n          const eleInfo3 = _.cloneDeep(mutation.payload);\r\n          this.updateElementInfo(\"normal\", eleInfo3);\r\n          break;\r\n        case \"synthesis/stp_set_null_element_id\":\r\n        // 单站pup: 清空当前选中的要素id\r\n        case \"synthesis/stp_update_station_id\":\r\n        // 单站pup: 更新站点\r\n        case \"synthesis/stp_update_times\":\r\n          // 单站pup: 更新时间\r\n          this.updateElementInfo(\"stationPup\");\r\n          break;\r\n      }\r\n    });\r\n  },\r\n  beforeDestroy() {\r\n    this.cancelSubscribe();\r\n  },\r\n  methods: {\r\n    ...mapMutations([\r\n      \"cut_split_screen\",\r\n      \"select_base_layer\",\r\n      \"select_layer_element\",\r\n      \"select_all_layer_element\"\r\n    ]),\r\n\r\n    updateElementInfo(typeName, eleInfo) {\r\n      // console.log(eleInfo.name);\r\n      if (typeName === \"normal\") {\r\n        // this.debouncedLc(eleInfo);\r\n        this.layerController(eleInfo);\r\n      } else if (typeName === \"stationPup\") {\r\n        //单站pup\r\n        // this.debouncedLcSationPup();\r\n        this.layerController_stationPup();\r\n      }\r\n    },\r\n\r\n    fcstWarnAndValueFcstInfo(type) {\r\n      const infoList = [];\r\n      switch (type) {\r\n        case \"fw_short_term\":\r\n          {\r\n            let { date, hour, aging } = this.fcstWarning.shortTerm;\r\n            aging = this.formatAging(aging);\r\n            const { typeName } = eleOption.fw_short_term;\r\n            const checked = aging !== \"\";\r\n            const id = \"fw_short_term\";\r\n            if (checked) {\r\n              if (date) {\r\n                const latestTime = date.format(\"YYYYMMDD\") + hour + \"00\";\r\n                infoList.push({\r\n                  id,\r\n                  checked,\r\n                  latestTime,\r\n                  aging\r\n                });\r\n              } else {\r\n                const message = typeName + (aging ? \"(\" + aging + \"h)\" : \"\");\r\n                this.$message.warning(message + \"暂无数据!\");\r\n              }\r\n            } else {\r\n              infoList.push({\r\n                id,\r\n                checked\r\n              });\r\n            }\r\n          }\r\n          break;\r\n        case \"fw_short_time\":\r\n          {\r\n            const { date, eleList } = this.fcstWarning.shortTime;\r\n            const { typeName } = eleOption.fw_short_time;\r\n            const checkedEle = eleList.find(el => el.checked);\r\n            const id = \"fw_short_time\";\r\n            if (checkedEle) {\r\n              //有值即代表选中\r\n              if (date) {\r\n                infoList.push({\r\n                  id,\r\n                  checked: true,\r\n                  latestTime: date,\r\n                  pathId: checkedEle.pathId\r\n                });\r\n              } else {\r\n                const message = typeName + \"(\" + checkedEle.name + \")\";\r\n                this.$message.warning(message + \"暂无数据!\");\r\n              }\r\n            } else {\r\n              infoList.push({\r\n                checked: false,\r\n                id\r\n              });\r\n            }\r\n          }\r\n          break;\r\n        case \"fw_warn_state\":\r\n          {\r\n            let { date, hour, aging } = this.fcstWarning.stateWarn;\r\n            aging = this.formatAging(aging);\r\n            const { typeName } = eleOption.fw_warn_state;\r\n            const checked = aging !== \"\";\r\n            const id = \"fw_warn_state\";\r\n            if (checked) {\r\n              if (date) {\r\n                const latestTime = date.format(\"YYYYMMDD\") + hour + \"00\";\r\n                infoList.push({\r\n                  id,\r\n                  checked,\r\n                  latestTime,\r\n                  aging\r\n                });\r\n              } else {\r\n                const message = typeName + \"(\" + aging + \"h)\";\r\n                this.$message.warning(message + \"暂无数据!\");\r\n              }\r\n            } else {\r\n              infoList.push({\r\n                checked,\r\n                id\r\n              });\r\n            }\r\n          }\r\n          break;\r\n        case \"fw_warn_province\":\r\n          {\r\n            const {\r\n              date,\r\n              hour,\r\n              minute,\r\n              aging,\r\n              eleList\r\n            } = this.fcstWarning.provinceWarn;\r\n            const { typeName } = eleOption.fw_warn_province;\r\n            const checkedEle = eleList.find(el => el.checked);\r\n            const id = \"fw_warn_province\";\r\n            if (checkedEle) {\r\n              if (date) {\r\n                const latestTime = date.format(\"YYYYMMDD\") + hour + minute;\r\n                infoList.push({\r\n                  id,\r\n                  checked: true,\r\n                  latestTime,\r\n                  pathId: checkedEle.pathId,\r\n                  aging\r\n                });\r\n              } else {\r\n                const message = typeName + \"(\" + checkedEle.name + aging + \"h)\";\r\n                this.$message.warning(message + \"暂无数据!\");\r\n              }\r\n            } else {\r\n              infoList.push({\r\n                checked: false,\r\n                id\r\n              });\r\n            }\r\n          }\r\n          break;\r\n        case \"vf\":\r\n          this.valueFcst.forEach(typeItem => {\r\n            const { id, date, hour, aging, typeEleList, typeEleId } = typeItem;\r\n            const currType = typeEleList.find(el => el.id === typeEleId);\r\n            const currEle = currType.eleList.find(el => el.checked);\r\n            const manageId = \"vf_\" + id;\r\n            const { typeName } = eleOption[manageId];\r\n            if (currEle) {\r\n              if (date) {\r\n                const latestTime = date.format(\"YYYYMMDD\") + hour + \"00\";\r\n                const level = currEle.type === \"无层次\" ? \"\" : currType.level;\r\n                infoList.push({\r\n                  id: manageId,\r\n                  checked: true,\r\n                  latestTime,\r\n                  pathId: currEle.pathId,\r\n                  aging,\r\n                  level\r\n                });\r\n              } else {\r\n                const message = typeName + \"(\" + currEle.name + aging + \")\";\r\n                this.$message.warning(message + \"暂无数据!\");\r\n              }\r\n            } else {\r\n              infoList.push({\r\n                checked: false,\r\n                id: manageId\r\n              });\r\n            }\r\n          });\r\n          break;\r\n      }\r\n\r\n      // console.log(infoList);\r\n      infoList.forEach(el => {\r\n        if (el.checked) {\r\n          this.renderElementData(el);\r\n        } else {\r\n          this.removeLayersById(el.id);\r\n        }\r\n      });\r\n    },\r\n\r\n    initMap() {\r\n      this.mapIds.forEach((id, i) => {\r\n        this[id] = L.map(id, {\r\n          center: [37.17782559332976, 107.314453125],\r\n          zoom: 5,\r\n          minZoom: 4,\r\n          maxZoom: 13,\r\n          attributionControl: false,\r\n          zoomControl: false\r\n        });\r\n\r\n        // L.control\r\n        //   .zoom({\r\n        //     position: id === \"map2\" || id === \"map4\" ? \"topleft\" : \"topright\"\r\n        //   })\r\n        //   .addTo(this[id]);\r\n\r\n        this[\"mapLayer\" + (i + 1)][\"default\"] = L.tileLayer(\r\n          eleOption.default.path,\r\n          { zIndex: 0 }\r\n        ).addTo(this[id]);\r\n\r\n        this[\"mapLayer\" + (i + 1)][\"layer_ele_boundary\"] = L.tileLayer(\r\n          eleOption.layer_ele_boundary.path,\r\n          { zIndex: 700 }\r\n        ).addTo(this[id]);\r\n\r\n        this[\"mapLayer\" + (i + 1)][\"layer_ele_point_name\"] = L.tileLayer(\r\n          eleOption.layer_ele_point_name.path,\r\n          { zIndex: 700 }\r\n        ).addTo(this[id]);\r\n\r\n        this[\"mapLayer\" + (i + 1)][\"layer_ele_river\"] = L.tileLayer(\r\n          eleOption.layer_ele_river.path,\r\n          { zIndex: 700 }\r\n        ).addTo(this[id]);\r\n      });\r\n\r\n      if (this.isSync) {\r\n        this.syncMap();\r\n      }\r\n    },\r\n\r\n    // 分屏结束时\r\n    onSplitScreenEnd(event) {\r\n      if (event.propertyName === \"width\" || event.propertyName === \"height\") {\r\n        const mapId = event.target.id.split(\"_\")[1];\r\n        // console.log(mapId);\r\n        this[mapId]._onResize();\r\n      }\r\n    },\r\n\r\n    // 切换分屏\r\n    onClickSwitchSplitScreen(index) {\r\n      this.cut_split_screen(index);\r\n    },\r\n\r\n    // 同步地图操作\r\n    syncMap() {\r\n      const currMap = this[this.currMapId];\r\n      this.mapIds.forEach(id => {\r\n        this[id].off(\"moveend\");\r\n      });\r\n      currMap.on(\"moveend\", e => {\r\n        const center = currMap.getCenter();\r\n        const zoom = currMap.getZoom();\r\n        // console.log(center, zoom);\r\n        this.mapIds.forEach(id => {\r\n          if (id === this.currMapId) return;\r\n          this[id].flyTo(center, zoom);\r\n        });\r\n      });\r\n    },\r\n\r\n    // 图层控制器(添加与删除图层)\r\n    layerController(elementInfo) {\r\n      const checked = elementInfo.checked;\r\n      // 选中\r\n      if (checked) {\r\n        // 选中但没有时间\r\n        if (\r\n          (elementInfo.latestTime === undefined && !elementInfo.time) ||\r\n          elementInfo.latestTime === \"\"\r\n        ) {\r\n          this.$message.warning(elementInfo.name + \"暂无数据!\");\r\n          return;\r\n        }\r\n        this.requestData(elementInfo);\r\n        return;\r\n      }\r\n\r\n      // 未选中\r\n      this.removeLayersById(elementInfo.id);\r\n    },\r\n\r\n    // 请求数据\r\n    requestData(elementInfo) {\r\n      if (elementInfo.conditionKey === \"currAcc\") {\r\n        //强天气>累计: 将conditionValue中的值更新到currAcc上\r\n        elementInfo.currAcc = elementInfo.conditionValue;\r\n      } else if (elementInfo.conditionKey === \"currObserve\") {\r\n        //强天气>观测: 将conditionValue中的值更新到currAcc上\r\n        elementInfo.currObserve = elementInfo.conditionValue;\r\n      } else if (elementInfo.latestTime === undefined) {\r\n        //所有: 将时间更新到latestTime\r\n        elementInfo.latestTime = elementInfo.time;\r\n      } else if (\r\n        elementInfo.currAging &&\r\n        elementInfo.latestAging === undefined\r\n      ) {\r\n        //云图: 将时效更新到latestAging\r\n        elementInfo.latestAging = elementInfo.currAging;\r\n      } else if (\r\n        elementInfo.currThreshold &&\r\n        elementInfo.latestThreshold === undefined\r\n      ) {\r\n        //自动站: 将阀值更新到latestThreshold\r\n        elementInfo.latestThreshold = elementInfo.currThreshold;\r\n      } else if (\r\n        elementInfo.currLevel &&\r\n        elementInfo.latestLevel === undefined\r\n      ) {\r\n        //SWAN拼图: 层次更新\r\n        elementInfo.latestLevel = elementInfo.currLevel;\r\n      }\r\n\r\n      this.renderElementData(elementInfo);\r\n    },\r\n\r\n    // 单站pup:图层控制器(添加与删除图层)\r\n    layerController_stationPup() {\r\n      // console.log(this.stationPup);\r\n      const {\r\n        moduleId,\r\n        currEleTime,\r\n        currEleId,\r\n        currStationId\r\n      } = this.stationPup;\r\n      const elementInfo = {\r\n        id: moduleId,\r\n        latestTime: currEleTime,\r\n        currEleId,\r\n        currStationId\r\n      };\r\n\r\n      if (currEleTime) {\r\n        if (currEleId) {\r\n          this.renderElementData(elementInfo);\r\n        } else {\r\n          this.removeLayersById(elementInfo.id);\r\n        }\r\n      } else {\r\n        this.$message.warning(\"单站pup暂无数据!\");\r\n      }\r\n    },\r\n\r\n    // 基础图层切换\r\n    renderBaseLayer() {\r\n      const currBaseLayerId = this.currSplitScreen.currBaseLayerId;\r\n      const baseLayerList = this.currSplitScreen.baseLayerList;\r\n      const currEleOption = eleOption[currBaseLayerId];\r\n\r\n      this.tileLayerRender(currEleOption.id, currEleOption.path);\r\n      baseLayerList.forEach(el => {\r\n        if (el.id === currBaseLayerId || el.id === \"default\") return;\r\n        this.removeLayer(el.id);\r\n      });\r\n\r\n      this.select_all_layer_element(currBaseLayerId !== \"xingzheng\");\r\n      this.currSplitScreen.layerElementList.forEach(item => {\r\n        const currEleOption = eleOption[item.id];\r\n        this.removeLayer(item.id);\r\n        if (item.checked) {\r\n          this.tileLayerRender(currEleOption.id, currEleOption.path, 700);\r\n        }\r\n      });\r\n    },\r\n\r\n    // 基础图层要素切换(边界线，行政点名称，河流等)\r\n    onClickSelectLayerElement(item) {\r\n      this.select_layer_element(item.id);\r\n      const currEleOption = eleOption[item.id];\r\n      this.removeLayer(item.id);\r\n      if (item.checked) {\r\n        this.tileLayerRender(currEleOption.id, currEleOption.path, 700);\r\n      }\r\n    },\r\n\r\n    // 渲染要素数据\r\n    renderElementData(elementInfo) {\r\n      const path = eleOption.getPath(elementInfo);\r\n      const currEleOption = eleOption[elementInfo.id];\r\n      const dataType = currEleOption.dataType;\r\n      // console.log(dataType);\r\n      switch (dataType) {\r\n        case \"tile\":\r\n          this.tileLayerRender(currEleOption.id, path);\r\n          break;\r\n        case \"imageOverlay\":\r\n          this.imageOverlayLayerRender(currEleOption.id, path);\r\n          break;\r\n        case \"text\":\r\n          this.textLayerRender(currEleOption.id, path);\r\n          break;\r\n        case \"dat\":\r\n          this.datLayerRender(currEleOption.id, path);\r\n          break;\r\n        case \"plot10min\":\r\n          this.plot10minLayerRender(elementInfo, path);\r\n          break;\r\n        case \"PupMosaicJson58\":\r\n          this.pupMosaicJson58LayerRender(elementInfo, path);\r\n          break;\r\n        case \"PupMosaicJson59\":\r\n          this.pupMosaicJson59LayerRender(elementInfo, path);\r\n          break;\r\n        case \"PupMosaicJson60\":\r\n          this.pupMosaicJson60LayerRender(elementInfo, path);\r\n          break;\r\n        case \"PupMosaicJson61\":\r\n          this.pupMosaicJson61LayerRender(elementInfo, path);\r\n          break;\r\n        case \"PupMosaicJson62\":\r\n          this.pupMosaicJson62LayerRender(elementInfo, path);\r\n          break;\r\n      }\r\n    },\r\n\r\n    // 添加tile图层\r\n    tileLayerRender(id, path, zIndex) {\r\n      zIndex = zIndex === undefined ? eleOption[id].zIndex : zIndex;\r\n\r\n      if (!this.currMapLayer[id]) {\r\n      }\r\n      const layer = L.tileLayer(path, { zIndex });\r\n      this.storeLayersById(id, layer);\r\n      this.removeLayer(id);\r\n      this.currMapLayer[id] = layer;\r\n      this.addLayer(id, layer);\r\n\r\n      // console.log(this.currMapLayer);\r\n      // console.log(layer);\r\n    },\r\n\r\n    // 添加imageOverlay图层\r\n    imageOverlayLayerRender(id, path) {\r\n      const { place, zIndex } = eleOption[id];\r\n      const renderImage = place => {\r\n        const imageBounds = L.latLngBounds(\r\n          L.latLng(place.south, place.west),\r\n          L.latLng(place.north, place.east)\r\n        );\r\n        const layer = L.imageOverlay(path, imageBounds, {\r\n          pane: \"tilePane\",\r\n          zIndex\r\n        });\r\n        this.storeLayersById(id, layer);\r\n        layer.on(\"load\", () => {\r\n          this.removeLayer(id);\r\n          this.currMapLayer[id] = layer;\r\n        });\r\n        layer.on(\"error\", () => {\r\n          this.removeLayer(id);\r\n          this.currMapLayer[id] = layer;\r\n        });\r\n        this.addLayer(id, layer);\r\n      };\r\n      if (place) {\r\n        renderImage(place);\r\n        return;\r\n      }\r\n\r\n      const CancelToken = axios.CancelToken;\r\n      this.cancelRequest(id);\r\n      axios\r\n        .get(path + \".json\", {\r\n          cancelToken: new CancelToken(c => {\r\n            let tokenList = this.currMapLayer[id + \"_token\"];\r\n            if (!tokenList) {\r\n              tokenList = this.currMapLayer[id + \"_token\"] = [];\r\n            }\r\n            tokenList.push(c);\r\n          })\r\n        })\r\n        .then(data => {\r\n          const place = data.data;\r\n          renderImage(place);\r\n        });\r\n    },\r\n\r\n    // 添加text图层\r\n    textLayerRender(id, path) {\r\n      const CancelToken = axios.CancelToken;\r\n      this.cancelRequest(id);\r\n      axios\r\n        .get(path, {\r\n          cancelToken: new CancelToken(c => {\r\n            let tokenList = this.currMapLayer[id + \"_token\"];\r\n            if (!tokenList) {\r\n              tokenList = this.currMapLayer[id + \"_token\"] = [];\r\n            }\r\n            tokenList.push(c);\r\n          })\r\n        })\r\n        .then(data => {\r\n          this.removeLayer(id);\r\n          const layer = L.RH.lightningLayer({});\r\n          layer.parseM4Data(data.data);\r\n          // layer.addTo(this.currMap);\r\n          this.storeLayersById(id, layer);\r\n          this.currMapLayer[id] = layer;\r\n          this.addLayer(id, layer);\r\n        });\r\n    },\r\n\r\n    // 添加dat图层\r\n    datLayerRender(id, path) {\r\n      const CancelToken = axios.CancelToken;\r\n      this.cancelRequest(id);\r\n      axios\r\n        .get(path, {\r\n          cancelToken: new CancelToken(c => {\r\n            let tokenList = this.currMapLayer[id + \"_token\"];\r\n            if (!tokenList) {\r\n              tokenList = this.currMapLayer[id + \"_token\"] = [];\r\n            }\r\n            tokenList.push(c);\r\n          })\r\n        })\r\n        .then(data => {\r\n          const gridData = parseM4Data(data.data);\r\n          const currEleOption = eleOption[id];\r\n          const { clevels, ccolors } = currEleOption;\r\n          this.gridDataToShade(id, gridData, clevels, ccolors);\r\n        });\r\n    },\r\n\r\n    gridDataToShade(id, GridData, clevels, ccolors) {\r\n      var n = GridData.lonCount,\r\n        m = GridData.latCount,\r\n        lonstart = GridData.startLon,\r\n        latstart = GridData.startLat,\r\n        longap = GridData.lonStep,\r\n        latgap = GridData.latStep,\r\n        values = [];\r\n\r\n      var min = null;\r\n      var max = null;\r\n\r\n      for (var i = 0; i < GridData.DS.length; i++) {\r\n        var v = GridData.DS[i];\r\n\r\n        if (v === 9999 || v === 9999.0) {\r\n          v = null;\r\n        }\r\n\r\n        if (min === null || (v !== null && v < min)) {\r\n          min = v;\r\n        }\r\n\r\n        if (max === null || (v !== null && v > max)) {\r\n          max = v;\r\n        }\r\n\r\n        values.push(v === null ? -9999 : v);\r\n      }\r\n\r\n      if (clevels.length * 4 != ccolors.length) {\r\n        throw new Error(\"ccolors length is not equal to clevels x 4\");\r\n      }\r\n\r\n      var colorMap = {};\r\n      for (var i = 0; i < clevels.length; i++) {\r\n        let val = clevels[i];\r\n\r\n        colorMap[\"\" + val] = [\r\n          ccolors[i * 4],\r\n          ccolors[i * 4 + 1],\r\n          ccolors[i * 4 + 2],\r\n          ccolors[i * 4 + 3]\r\n        ];\r\n      }\r\n\r\n      var thresholds = clevels;\r\n\r\n      var contours = d3Contour\r\n        .contours()\r\n        .size([n, m])\r\n        .smooth(true)\r\n        .thresholds(thresholds)(values);\r\n\r\n      for (var s = 0; s < contours.length; s++) {\r\n        var d = contours[s];\r\n\r\n        for (var i = 0; i < d.coordinates.length; i++) {\r\n          for (var k = 0; k < d.coordinates[i].length; k++) {\r\n            for (var j = 0; j < d.coordinates[i][k].length; j++) {\r\n              var entity = d.coordinates[i][k][j];\r\n\r\n              var a0 = entity[0];\r\n              var a1 = entity[1];\r\n\r\n              entity[0] = lonstart + a0 * longap;\r\n              entity[1] = latstart + a1 * latgap;\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      var geoJson = { type: \"FeatureCollection\", features: contours };\r\n\r\n      var layer = L.geoJSON(geoJson, {\r\n        pane: \"tilePane\",\r\n        style: feature => {\r\n          var v = feature.geometry.value;\r\n\r\n          var cor = colorMap[\"\" + v];\r\n\r\n          return {\r\n            weight: 0,\r\n            fillOpacity: cor[3] / 255,\r\n            color: \"rgb(\" + cor[0] + \",\" + cor[1] + \",\" + cor[2] + \")\"\r\n          };\r\n        }\r\n      });\r\n      this.removeLayer(id);\r\n      // layer.addTo(this.currMap);\r\n      this.storeLayersById(id, layer);\r\n      this.addLayer(id, layer);\r\n    },\r\n\r\n    // 添加plot10min图层\r\n    plot10minLayerRender(elementInfo, path) {\r\n      const CancelToken = axios.CancelToken;\r\n      this.cancelRequest(elementInfo.id);\r\n      axios\r\n        .get(path, {\r\n          cancelToken: new CancelToken(c => {\r\n            let tokenList = this.currMapLayer[elementInfo.id + \"_token\"];\r\n            if (!tokenList) {\r\n              tokenList = this.currMapLayer[elementInfo.id + \"_token\"] = [];\r\n            }\r\n            tokenList.push(c);\r\n          })\r\n        })\r\n        .then(data => {\r\n          data = data.data;\r\n          if (data != null) {\r\n            //判断是否有数据\r\n            if (data.substring && data.substring(1, 4) == \"PNG\") {\r\n              // getErrorPrompt(\"自动站降水,\" + time);\r\n            }\r\n            var datas = [];\r\n            for (var i = 0; i < data.features.length; i++) {\r\n              var feature = data.features[i].geometry;\r\n              feature.type = this.capitalizeFirstLetter(feature.type);\r\n              datas.push({\r\n                latlng: feature.coordinates,\r\n                properties: data.features[i].properties\r\n              });\r\n            }\r\n            if (elementInfo.name === \"极大风\") {\r\n              this.zdzWindRender(elementInfo, datas);\r\n            } else {\r\n              this.zdzCommonRender(elementInfo, datas);\r\n            }\r\n          }\r\n        });\r\n    },\r\n    capitalizeFirstLetter(string) {\r\n      return string.charAt(0).toUpperCase() + string.slice(1);\r\n    },\r\n\r\n    // 自动站报警--wind\r\n    zdzWindRender(elementInfo, datas) {\r\n      const threshold = elementInfo.latestThreshold;\r\n      var zdzDatas = [];\r\n      for (var i = 0; i < datas.length; i++) {\r\n        var item = datas[i];\r\n        const { ID, WS, WD, T, R, MaxWind_Time } = item.properties;\r\n        if (WS != 9999 && WD != 9999) {\r\n          if (WS >= threshold) {\r\n            zdzDatas.push({\r\n              stationId: ID,\r\n              stationName: \"\",\r\n              lng: item.latlng[0],\r\n              lat: item.latlng[1],\r\n              datas: [WS, null, null, null],\r\n              datasVisibilityMask: [true, false, false, false],\r\n              showAnyway: true,\r\n              windSD: {\r\n                speed: WS,\r\n                dir: WD\r\n              },\r\n              stationImageUrl: null,\r\n              properties: { ID, WS, WD, T, R, MaxWind_Time },\r\n              vaneColorFn: function(speed, direcation) {\r\n                var ret = \"black\";\r\n                if (speed >= 17 && speed < 25) {\r\n                  ret = \"#F0F\";\r\n                } else if (speed >= 25 && speed < 30) {\r\n                  ret = \"#FF6600\";\r\n                } else if (speed >= 30) {\r\n                  ret = \"#211551\";\r\n                }\r\n                return ret;\r\n              }\r\n            });\r\n          }\r\n        }\r\n      }\r\n\r\n      var windLayer = L.RH.zdzLayer({\r\n        clickHandler: item => {\r\n          if (this._popup) {\r\n            this._popup.remove();\r\n            this._popup = null;\r\n          }\r\n          setTimeout(() => {\r\n            this._popup = L.popup({ maxWidth: 500 })\r\n              .setLatLng(L.latLng(item.lat, item.lng))\r\n              .setContent('<div class=\"my-marker-cluster-popup\">xxxxx</div>')\r\n              .openOn(this.currMap);\r\n            console.log(this._popup);\r\n            this.getZdzInfo(this._popup, {\r\n              ...item.properties,\r\n              id: item.stationId\r\n            });\r\n          });\r\n        }\r\n      });\r\n      windLayer.setData(zdzDatas);\r\n\r\n      this.removeLayer(elementInfo.id);\r\n      this.currMapLayer[elementInfo.id] = windLayer;\r\n      this.storeLayersById(id, windLayer);\r\n      const isHideLayer = this.showHideLayerHash[elementInfo.id].isHideLayer;\r\n      if (!isHideLayer) {\r\n        this.currMap.addLayer(windLayer);\r\n      }\r\n    },\r\n\r\n    // 自动站报警-rain,temp\r\n    zdzCommonRender(elementInfo, datas) {\r\n      const eleNameHash = {\r\n        降水: \"R\",\r\n        // \"极大风\": \"WS\",\r\n        \"温度>\": \"T\",\r\n        \"温度<\": \"T\"\r\n      };\r\n      const eleKey = eleNameHash[elementInfo.name];\r\n      const threshold = elementInfo.latestThreshold;\r\n\r\n      var markers = L.markerClusterGroup({\r\n        showCoverageOnHover: false,\r\n        maxClusterRadius: 50,\r\n        iconCreateFunction: function(cluster) {\r\n          var markers = cluster.getAllChildMarkers();\r\n          const extMarker = markers.slice().sort((a, b) => {\r\n            if (elementInfo.name === \"温度<\") {\r\n              return a._myData.currData - b._myData.currData;\r\n            }\r\n            return b._myData.currData - a._myData.currData;\r\n          })[0];\r\n          const { id, currData } = extMarker._myData;\r\n          let isWarning = false;\r\n          if (elementInfo.name === \"温度<\") {\r\n            isWarning = currData <= threshold;\r\n          } else {\r\n            isWarning = currData >= threshold;\r\n          }\r\n          const icon = new L.DivIcon({\r\n            className:\r\n              \"my-marker-cluster\" + (isWarning ? \" my-marker-ani\" : \"\"),\r\n            html: `<div>${currData}</div>`,\r\n            iconSize: new L.Point(40, 40)\r\n          });\r\n          return icon;\r\n        }\r\n      });\r\n\r\n      datas.forEach((item, i) => {\r\n        const props = item.properties;\r\n        const id = props[\"ID\"];\r\n        const currData = props[eleKey];\r\n        if (currData === undefined || currData == 9999) return;\r\n\r\n        let isWarning = false;\r\n        if (elementInfo.name === \"温度<\") {\r\n          isWarning = currData <= threshold;\r\n        } else {\r\n          isWarning = currData >= threshold;\r\n        }\r\n\r\n        const myIcon = L.divIcon({\r\n          className:\r\n            \"my-marker-cluster-marker\" + (isWarning ? \" my-marker-ani\" : \"\"),\r\n          html: `<div>${currData}</div>`\r\n        });\r\n        const marker = L.marker(new L.LatLng(item.latlng[1], item.latlng[0]), {\r\n          icon: myIcon\r\n        });\r\n        marker._myData = { id, currData };\r\n        marker.bindPopup('<div class=\"my-marker-cluster-popup\"></div>', {\r\n          maxWidth: 500\r\n        });\r\n\r\n        marker.on(\"click\", () => {\r\n          this.getZdzInfo(marker, { ...props, id }, false);\r\n        });\r\n\r\n        markers.addLayer(marker);\r\n      });\r\n\r\n      this.removeLayer(elementInfo.id);\r\n      this.currMapLayer[elementInfo.id] = markers;\r\n      this.storeLayersById(id, markers);\r\n      const isHideLayer = this.showHideLayerHash[elementInfo.id].isHideLayer;\r\n      if (!isHideLayer) {\r\n        this.currMap.addLayer(markers);\r\n      }\r\n    },\r\n\r\n    getZdzInfo(obj, props, isPopup = true) {\r\n      const params = new URLSearchParams();\r\n      params.append(\"stationId\", this.getStationId(props.id));\r\n      axios\r\n        .post(\"/proxy/10.20.67.111/stweather/StationDataInfoServlet\", params)\r\n        .then(data => {\r\n          const name = data.data;\r\n          obj[\r\n            isPopup ? \"setContent\" : \"setPopupContent\"\r\n          ](`<div class=\"my-marker-cluster-popup\">\r\n            <ul>\r\n              <li>\r\n                <div>\r\n                  <span>站号:</span>\r\n                  <span>${props.id}</span>\r\n                </div>\r\n                <div>\r\n                  <span>站名:</span>\r\n                  <span>${name}</span>\r\n                </div>\r\n              </li>\r\n              <li>\r\n                <div>\r\n                  <span>降水:</span>\r\n                  <span>${props.R === undefined ? \"\" : props.R}mm</span>\r\n                </div>\r\n                <div>\r\n                  <span>温度:</span>\r\n                  <span>${props.T === undefined ? \"\" : props.T}℃</span>\r\n                </div>\r\n              </li>\r\n              <li>\r\n                <div>\r\n                  <span>风力:</span>\r\n                  <span>${props.WS === undefined ? \"\" : props.WS}m/s</span>\r\n                </div>\r\n                <div>\r\n                  <span>风向:</span>\r\n                  <span>${props.WD === undefined ? \"\" : props.WD}</span>\r\n                </div>\r\n              </li>\r\n              <li>\r\n                <div>\r\n                  <span>极大风出现时间:</span>\r\n                  <span>${\r\n                    props.MaxWind_Time === undefined ? \"\" : props.MaxWind_Time\r\n                  }</span>\r\n                </div>\r\n              </li>\r\n            </ul>\r\n            </div>`);\r\n        });\r\n    },\r\n\r\n    getStationId(id) {\r\n      id = id + \"\";\r\n      return String.fromCharCode(id.slice(0, 2)) + id.slice(2);\r\n    },\r\n\r\n    pupMosaicJson58LayerRender(elementInfo, path) {\r\n      const CancelToken = axios.CancelToken;\r\n      this.cancelRequest(elementInfo.id);\r\n      axios\r\n        .get(path, {\r\n          cancelToken: new CancelToken(c => {\r\n            let tokenList = this.currMapLayer[elementInfo.id + \"_token\"];\r\n            if (!tokenList) {\r\n              tokenList = this.currMapLayer[elementInfo.id + \"_token\"] = [];\r\n            }\r\n            tokenList.push(c);\r\n          })\r\n        })\r\n        .then(data => {\r\n          const dataList = data.data.features;\r\n          console.log(dataList);\r\n\r\n          var markers = L.markerClusterGroup({\r\n            showCoverageOnHover: false,\r\n            maxClusterRadius: 50,\r\n            iconCreateFunction: function(cluster) {\r\n              const icon = new L.DivIcon({\r\n                className: \"my-marker-cluster-yellow icon-fbzz my-marker-ani\",\r\n                html: '',\r\n                iconSize: new L.Point(40, 40)\r\n              });\r\n              return icon;\r\n            }\r\n          });\r\n\r\n          dataList.forEach((item, i) => {\r\n            const props = item.properties;\r\n\r\n            const myIcon = L.divIcon({\r\n              className: \"my-marker-yellow icon-fbzz my-marker-ani\",\r\n              html: `<div>${props.id}</div>`\r\n            });\r\n            const marker = L.marker(\r\n              new L.LatLng(props.lat, props.lon),\r\n              {\r\n                icon: myIcon\r\n              }\r\n            );\r\n            marker.bindPopup('<div class=\"my-marker-cluster-popup\">xxxxxx</div>', {\r\n              maxWidth: 500\r\n            });\r\n            markers.addLayer(marker);\r\n          });\r\n\r\n          this.removeLayer(elementInfo.id);\r\n          this.currMapLayer[elementInfo.id] = markers;\r\n          this.storeLayersById(elementInfo.id, markers);\r\n          const isHideLayer = this.showHideLayerHash[elementInfo.id]\r\n            .isHideLayer;\r\n          if (!isHideLayer) {\r\n            this.currMap.addLayer(markers);\r\n          }\r\n        });\r\n    },\r\n    pupMosaicJson59LayerRender(elementInfo, path) {\r\n      const CancelToken = axios.CancelToken;\r\n      this.cancelRequest(elementInfo.id);\r\n      axios\r\n        .get(path, {\r\n          cancelToken: new CancelToken(c => {\r\n            let tokenList = this.currMapLayer[elementInfo.id + \"_token\"];\r\n            if (!tokenList) {\r\n              tokenList = this.currMapLayer[elementInfo.id + \"_token\"] = [];\r\n            }\r\n            tokenList.push(c);\r\n          })\r\n        })\r\n        .then(data => {\r\n          const dataList = data.data.features;\r\n          console.log(dataList);\r\n\r\n          var markers = L.markerClusterGroup({\r\n            showCoverageOnHover: false,\r\n            maxClusterRadius: 50,\r\n            iconCreateFunction: function(cluster) {\r\n              const icon = new L.DivIcon({\r\n                className: \"my-marker-cluster-yellow icon-bbzs my-marker-ani\",\r\n                html: '',\r\n                iconSize: new L.Point(40, 40)\r\n              });\r\n              return icon;\r\n            }\r\n          });\r\n\r\n          dataList.forEach((item, i) => {\r\n            const props = item.properties;\r\n\r\n            const myIcon = L.divIcon({\r\n              className: \"my-marker-yellow icon-bbzs my-marker-ani\",\r\n              html: ``,\r\n              iconSize: new L.Point(40, 40)\r\n            });\r\n            const marker = L.marker(\r\n              new L.LatLng(props.lat, props.lon),\r\n              {\r\n                icon: myIcon\r\n              }\r\n            );\r\n            marker.bindPopup('<div class=\"my-marker-cluster-popup\">xxxxxx</div>', {\r\n              maxWidth: 500\r\n            });\r\n            markers.addLayer(marker);\r\n          });\r\n\r\n          this.removeLayer(elementInfo.id);\r\n          this.currMapLayer[elementInfo.id] = markers;\r\n          this.storeLayersById(elementInfo.id, markers);\r\n          const isHideLayer = this.showHideLayerHash[elementInfo.id]\r\n            .isHideLayer;\r\n          if (!isHideLayer) {\r\n            this.currMap.addLayer(markers);\r\n          }\r\n\r\n\r\n\r\n        });\r\n    },\r\n    pupMosaicJson60LayerRender(elementInfo, path) {\r\n      const CancelToken = axios.CancelToken;\r\n      this.cancelRequest(elementInfo.id);\r\n      axios\r\n        .get(path, {\r\n          cancelToken: new CancelToken(c => {\r\n            let tokenList = this.currMapLayer[elementInfo.id + \"_token\"];\r\n            if (!tokenList) {\r\n              tokenList = this.currMapLayer[elementInfo.id + \"_token\"] = [];\r\n            }\r\n            tokenList.push(c);\r\n          })\r\n        })\r\n        .then(data => {\r\n          const dataList = data.data.features;\r\n          console.log(dataList);\r\n        });\r\n    },\r\n    pupMosaicJson61LayerRender(elementInfo, path) {\r\n      const CancelToken = axios.CancelToken;\r\n      this.cancelRequest(elementInfo.id);\r\n      axios\r\n        .get(path, {\r\n          cancelToken: new CancelToken(c => {\r\n            let tokenList = this.currMapLayer[elementInfo.id + \"_token\"];\r\n            if (!tokenList) {\r\n              tokenList = this.currMapLayer[elementInfo.id + \"_token\"] = [];\r\n            }\r\n            tokenList.push(c);\r\n          })\r\n        })\r\n        .then(data => {\r\n          const dataList = data.data.features;\r\n          console.log(dataList);\r\n        });\r\n    },\r\n    pupMosaicJson62LayerRender(elementInfo, path) {\r\n      const CancelToken = axios.CancelToken;\r\n      this.cancelRequest(elementInfo.id);\r\n      axios\r\n        .get(path, {\r\n          cancelToken: new CancelToken(c => {\r\n            let tokenList = this.currMapLayer[elementInfo.id + \"_token\"];\r\n            if (!tokenList) {\r\n              tokenList = this.currMapLayer[elementInfo.id + \"_token\"] = [];\r\n            }\r\n            tokenList.push(c);\r\n          })\r\n        })\r\n        .then(data => {\r\n          const dataList = data.data.features;\r\n          console.log(dataList);\r\n        });\r\n    },\r\n\r\n    // 存储指定要素下所有加载的图层\r\n    storeLayersById(id, layer) {\r\n      id = \"all_layer_\" + id;\r\n      let layers = this.currMapLayer[id];\r\n      if (!Array.isArray(layers)) {\r\n        layers = this.currMapLayer[id] = [];\r\n      }\r\n      layers.push(layer);\r\n    },\r\n\r\n    // 添加图层\r\n    addLayer(id, layer) {\r\n      let isShowLayer;\r\n      if (this.showHideLayerHash[id] === undefined) {\r\n        isShowLayer = true;\r\n      } else {\r\n        isShowLayer = !this.showHideLayerHash[id].isHideLayer;\r\n      }\r\n      if (isShowLayer) {\r\n        layer.addTo(this.currMap);\r\n      }\r\n    },\r\n\r\n    // 删除指定要素下所有加载的图层\r\n    removeLayersById(id) {\r\n      id = \"all_layer_\" + id;\r\n      let layers = this.currMapLayer[id];\r\n      if (Array.isArray(layers)) {\r\n        layers.forEach(lr => lr.remove());\r\n        this.currMapLayer[id] = [];\r\n      }\r\n    },\r\n\r\n    // 删除图层\r\n    removeLayer(id) {\r\n      const layer = this.currMapLayer[id];\r\n      if (layer) {\r\n        layer.remove();\r\n        this.currMapLayer[id] = null;\r\n      }\r\n    },\r\n\r\n    // 取消请求\r\n    cancelRequest(id) {\r\n      const tokenList = this.currMapLayer[id + \"_token\"];\r\n      if (tokenList && Array.isArray(tokenList)) {\r\n        tokenList.forEach(c => c());\r\n        this.currMapLayer[id + \"_token\"] = null;\r\n      }\r\n    },\r\n\r\n    // 格式化时效\r\n    formatAging(aging) {\r\n      const leng = (\"\" + aging).length;\r\n      if (leng === 1) {\r\n        aging = \"00\" + aging;\r\n      } else if (leng === 2) {\r\n        aging = \"0\" + aging;\r\n      }\r\n      return aging;\r\n    }\r\n  }\r\n};\r\n"]}]}