{"remainingRequest":"D:\\program\\frontend\\node_modules\\babel-loader\\lib\\index.js!D:\\program\\frontend\\src\\views\\diagnosis\\diagnosis.js?vue&type=script&lang=js&","dependencies":[{"path":"D:\\program\\frontend\\src\\views\\diagnosis\\diagnosis.js","mtime":1553855602525},{"path":"D:\\program\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\program\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _slicedToArray from \"D:\\\\program\\\\frontend\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/slicedToArray\";\nimport \"core-js/modules/es6.array.fill\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.find-index\";\nimport \"core-js/modules/es6.array.find\";\nimport \"core-js/modules/es6.regexp.split\";\nimport _parseInt from \"D:\\\\program\\\\frontend\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/parse-int\";\nimport _JSON$stringify from \"D:\\\\program\\\\frontend\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/json/stringify\";\nimport _objectSpread from \"D:\\\\program\\\\frontend\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/objectSpread\";\nimport * as moment from \"moment\";\nimport * as axios from \"axios\";\nimport _ from 'lodash';\nimport { DateSelect, LevelSelect, AreaSelect, WholeAgingSelect, TimeSelect, AgingSelect, ImgShow, SideBar, Login } from \"../../components/share\";\nimport { ToolBtn } from '../../components/base';\nimport options from \"../../assets/config/diagnosis_config\";\nimport { createNamespacedHelpers } from \"vuex\";\n\nvar _createNamespacedHelp = createNamespacedHelpers(\"synthesis\"),\n    mapState = _createNamespacedHelp.mapState,\n    mapGetters = _createNamespacedHelp.mapGetters,\n    mapMutations = _createNamespacedHelp.mapMutations;\n\nexport default {\n  name: \"Diagnosis\",\n  components: {\n    DateSelect: DateSelect,\n    LevelSelect: LevelSelect,\n    AreaSelect: AreaSelect,\n    WholeAgingSelect: WholeAgingSelect,\n    TimeSelect: TimeSelect,\n    AgingSelect: AgingSelect,\n    ImgShow: ImgShow,\n    SideBar: SideBar,\n    Login: Login,\n    ToolBtn: ToolBtn\n  },\n  data: function data() {\n    return {\n      dieSwitch: false,\n      login_switch: false,\n      // 该引用存储短期所有配置\n      options: options,\n      img_active: false,\n      cancelRequests: [],\n      loginzt: false,\n      area: \"全国\",\n      activeIndex: null,\n      // 当前选中的预报类型\n      currFcstName: \"地面\",\n      // 该引用当前选中的要素配置\n      currEleOption: null,\n      // 该引用当前预报配置\n      currFcstOption: null,\n      // 该引用含有当前起报时间以及当前选中要素的id\n      currTypeOption: null,\n      // 当前选中路径下的所有要素id的列表\n      currEleIdList: [],\n      // 图片地址\n      user: '',\n      activeClose: false,\n      pass: '',\n      imgPaths: [],\n      coverPaths: [],\n      login_data: {},\n      currDate: null,\n      zoomSw: false,\n      currHour: '02',\n      hourList: ['02', '05', '08', '11', '14', '17', '20', '23'],\n      interval: '24h'\n    };\n  },\n  computed: _objectSpread({}, mapState([\"zoomSwitch\", \"zoomUrl\"]), {\n    // 当前起报时间\n    startTime: function startTime() {\n      if (this.currTypeOption && moment.isMoment(this.currTypeOption.date)) {\n        return this.currTypeOption.date.format('YYYY-MM-DD') + ' ' + this.currTypeOption.hour;\n      }\n\n      return '';\n    },\n    currEleIdListLength: function currEleIdListLength() {\n      return this.currEleIdList.length;\n    }\n  }),\n  created: function created() {\n    this.debouncedFindCondition = _.debounce(this.findCondition, 300);\n  },\n  mounted: function mounted() {\n    this.findCondition();\n  },\n  beforeDestroy: function beforeDestroy() {\n    this.cancelAllRequest();\n  },\n  watch: {\n    imgPaths: function imgPaths() {\n      this.updata_zoomUrl(this.imgPaths[0]);\n    }\n  },\n  methods: _objectSpread({\n    moment: moment,\n    preChange: function preChange(val) {\n      options[1].contents[0].slevel = val;\n      this.onConditionChange();\n    },\n    highChange: function highChange(val) {\n      options[1].contents[0].glevel = val;\n      this.onConditionChange();\n    }\n  }, mapMutations([\"updata_zoomSwitch\", \"updata_zoomUrl\"]), {\n    show_zoom: function show_zoom() {\n      this.updata_zoomSwitch(true);\n      this.updata_zoomUrl(this.imgPaths[0]);\n    },\n    // ...mapMutations([\n    //   \"updata_zoomSwitch\",\n    // ]),\n    close: function close() {\n      this.updata_zoomSwitch(false);\n    },\n    loginF: function loginF(i) {\n      // console.log(i)\n      if (i) {\n        if (this.user == 'swpc' && this.pass == 'swpc') {\n          this.loginFn(this.interval, moment(this.currDate).add(this.currHour, 'hour').format('YYYY-MM-DD HH:mm:ss'));\n          this.login_switch = false;\n        } else {\n          alert('用户名或密码错误');\n        }\n      } else {\n        this.login_switch = false;\n        this.activeIndex = null;\n      }\n    },\n    select: function select(i) {\n      this.activeClose = !this.activeClose;\n\n      if (this.activeIndex == i) {\n        if (!this.activeClose) {\n          this.activeIndex = null;\n          this.dieSwitch = false;\n          this.dieFn(); // alert(options[0].contents[0].hour)\n\n          this.currHour = options[0].contents[0].hour;\n          this.loginzt = false;\n          this.activeClose = false;\n        }\n      } else {\n        // let value=JSON.parse(JSON.stringify(options[0].contents[0].date))\n        this.currHour = options[0].contents[0].hour;\n        this.currDate = moment(JSON.parse(_JSON$stringify(options[0].contents[0].date)));\n\n        if (i === 1) {\n          this.loginzt = true;\n          this.dieFn(this.interval, moment(this.currDate).add(this.currHour, 'hour').format('YYYY-MM-DD HH:mm:ss'));\n        } else {\n          this.login_switch = true;\n          this.loginzt = false;\n        }\n\n        this.activeIndex = i;\n      }\n    },\n    changDate: function changDate(i) {\n      var time = moment(this.currDate.format('YYYYMMDD 00:00:00'), 'YYYYMMDD HH:mm:ss').add(this.currHour, 'hours'); // console.log( time)\n\n      if (i === 1) {\n        time.add(_parseInt(this.loginzt ? this.interval : 1), 'hours');\n      } else {\n        time.subtract(_parseInt(this.loginzt ? this.interval : 1), 'hours');\n      }\n\n      this.currDate = time;\n      this.currHour = time.format('HH');\n\n      if (this.activeIndex == 2) {\n        this.loginFn(this.interval, moment(this.currDate).format('YYYY-MM-DD HH:mm:ss'));\n      } else if (this.activeIndex == 1) {\n        this.dieFn(this.interval, moment(this.currDate).format('YYYY-MM-DD HH:mm:ss'));\n      } // this.$emit('dieFn',this.interval,moment(this.currDate).format('YYYY-MM-DD HH:mm:ss'))\n\n    },\n    changeHour: function changeHour() {\n      if (this.activeIndex == 1) {\n        // console.log(moment(this.currDate).format('YYYY-MM-DD HH:mm:ss'))\n        this.dieFn(this.interval, moment(this.currDate).format('YYYY-MM-DD HH:mm:ss'));\n      } else {\n        this.loginFn(this.interval, moment(this.currDate).add(this.currHour, 'hour').format('YYYY-MM-DD HH:mm:ss'));\n      }\n    },\n    dieFn: function dieFn(interval, date) {\n      var _this = this;\n\n      // document.querySelector('.imgDie').innerHTML = ''\n      this.coverPaths = []; // console.log(interval, date)\n\n      if (interval && date) {\n        this.dieSwitch = true;\n        var data = {\n          'modeName': 'qiangtianqi',\n          'eleName': \"OBSoverlay:\\u5B9E\\u51B5\\u53E0\\u52A0:\".concat(interval),\n          'forecastTime': date,\n          'level': '',\n          'userDefinedParas': '',\n          'strTime': date,\n          'symbol': 1\n        };\n        var params = new URLSearchParams();\n\n        for (var key in data) {\n          params.append(key, data[key]);\n        }\n\n        axios.post(\"/proxy/10.20.67.111/PictureInfoForgetFilePath.action\", params).then(function (res) {\n          _this.coverPaths.push(\"http://10.20.67.111/getPic.action2?ppath=\".concat(res.data.path.split(',')[5])); // console.log(res.data.path.split(','))\n          // let img = new Image()\n          // img.src = `http://10.20.67.111/getPic.action2?ppath=${res.data.path.split(',')[5]}`\n          // img.style.cssText = 'width:100%;height:100%;'\n          // // this.dieImgSrc=`http://10.20.67.111/getPic.action2?ppath=\\\\${res.data.path.split(',')[5]}`\n          // img.onload = () => {\n          //   document.querySelector('.imgDie').appendChild(img)\n          // }\n          // img.onerror = () => {\n          //   img.src = require('../../assets/images/404.png')\n          //   document.querySelector('.imgDie').appendChild(img)\n          // }\n\n        });\n      } else {\n        // alert\n        this.coverPaths = [];\n      }\n    },\n    loginFn: function loginFn(interval, date) {\n      var _this2 = this;\n\n      // if (this.loginzt) {\n      this.coverPaths = []; // document.querySelector('.imgDie').innerHTML = ''\n      // console.log(interval, date)\n\n      if (interval && date) {\n        this.dieSwitch = true;\n        var data = {\n          'modeName': 'qiangtianqi',\n          'eleName': \"forecastoverlay:\\u9884\\u62A5\",\n          'forecastTime': moment(date, 'YYYY-MM-DD HH:mm:ss').add(_parseInt(this.interval), 'hour').format('YYYY-MM-DD HH:mm:ss'),\n          'level': '',\n          'userDefinedParas': '',\n          'strTime': date,\n          'symbol': 2\n        };\n        var params = new URLSearchParams();\n\n        for (var key in data) {\n          params.append(key, data[key]);\n        }\n\n        axios.post(\"/proxy/10.20.67.111/PictureInfoForgetFilePath.action\", params).then(function (res) {\n          _this2.coverPaths.push(\"http://10.20.67.111/getPic.action2?ppath=\".concat(res.data.path.split(',')[5])); // console.log(res.data.path.split(','))\n          // let img = new Image()\n          // img.src = `http://10.20.67.111/getPic.action2?ppath=${res.data.path.split(',')[5]}`\n          // img.style.cssText = 'width:100%;height:100%;'\n          // // this.dieImgSrc=`http://10.20.67.111/getPic.action2?ppath=\\\\${res.data.path.split(',')[5]}`\n          // img.onload = () => {\n          //   document.querySelector('.imgDie').appendChild(img)\n          // }\n          // img.onerror = () => {\n          //   img.src = require('../../assets/images/404.png')\n          //   document.querySelector('.imgDie').appendChild(img)\n          // }\n\n        });\n      } // } else {\n      //   if (interval && date) {\n      //     this.login_data = {\n      //       interval, date\n      //     }\n      //     this.login_switch = true\n      //   } else {\n      //     this.dieSwitch = false\n      //     this.login_switch = false\n      //   }\n      // }\n\n    },\n    loginResult: function loginResult(val) {\n      this.loginzt = val;\n      this.login_switch = false;\n\n      if (val) {\n        document.querySelector('.imgDie').innerHTML = ''; // console.log(interval, date)\n\n        if (this.login_data.interval && this.login_data.date) {\n          this.dieSwitch = true;\n          var data = {\n            'modeName': 'qiangtianqi',\n            'eleName': \"forecastoverlay:\\u9884\\u62A5\",\n            'forecastTime': this.login_data.date,\n            'level': '',\n            'userDefinedParas': '',\n            'strTime': this.login_data.date,\n            'symbol': 1\n          };\n          var params = new URLSearchParams();\n\n          for (var key in data) {\n            params.append(key, data[key]);\n          }\n\n          axios.post(\"/proxy/10.20.67.111/PictureInfoForgetFilePath.action\", params).then(function (res) {\n            // console.log(res.data.path.split(','))\n            var img = new Image();\n            img.src = \"http://10.20.67.111/getPic.action2?ppath=\".concat(res.data.path.split(',')[5]);\n            img.style.cssText = 'width:100%;height:100%;'; // this.dieImgSrc=`http://10.20.67.111/getPic.action2?ppath=\\\\${res.data.path.split(',')[5]}`\n\n            img.onload = function () {\n              document.querySelector('.imgDie').appendChild(img);\n            };\n\n            img.onerror = function () {\n              img.src = require('../../assets/images/404.png');\n              document.querySelector('.imgDie').appendChild(img);\n            };\n          });\n        }\n      }\n    },\n    // 键盘事件监听\n    onKeyup: function onKeyup(event) {\n      var _this3 = this;\n\n      var code = event.code;\n\n      if (code === 'ArrowLeft') {\n        this.$refs.wholeAgingSelect[0].onTuningAging(-1);\n      } else if (code === 'ArrowRight') {\n        this.$refs.wholeAgingSelect[0].onTuningAging(1);\n      } else if (code === 'ArrowUp' || code === 'ArrowDown') {\n        var activeElementId = '';\n        var isProb = this.currFcstName === '概率预报';\n\n        if (isProb) {\n          activeElementId = this.options.find(function (el) {\n            return el.fcstName === _this3.currFcstName;\n          }).activeElementId;\n        } else {\n          activeElementId = this.currTypeOption.activeElementId;\n        }\n\n        var currIndex = this.currEleIdList.findIndex(function (id) {\n          return id === activeElementId;\n        });\n        if (currIndex === -1) return;\n        var nextIndex = currIndex + (code === 'ArrowUp' ? -1 : 1);\n\n        if (nextIndex <= 0) {\n          nextIndex = this.currEleIdListLength - 1;\n        } else if (nextIndex >= this.currEleIdListLength) {\n          nextIndex = 0;\n        }\n\n        var nextActiveElementId = this.currEleIdList[nextIndex];\n\n        if (isProb) {\n          this.options.find(function (el) {\n            return el.fcstName === _this3.currFcstName;\n          }).activeElementId = nextActiveElementId;\n        } else {\n          this.currTypeOption.activeElementId = nextActiveElementId;\n        }\n\n        this.debouncedFindCondition();\n      }\n    },\n    // 图片切换事件\n    onSwitchImg: function onSwitchImg(sign) {\n      if (sign === 'left') {\n        this.$refs.wholeAgingSelect[0].onTuningAging(-1);\n      } else if (sign === 'right') {\n        this.$refs.wholeAgingSelect[0].onTuningAging(1);\n      } else if (sign === 'top') {\n        this.$refs.levelSelect.onTuningLevel(1);\n      } else if (sign === 'bottom') {\n        this.$refs.levelSelect.onTuningLevel(-1);\n      }\n    },\n    // 条件改变时\n    onConditionChange: function onConditionChange() {\n      this.debouncedFindCondition();\n    },\n    //点击要素时\n    onClickElement: function onClickElement(curr, itemId) {\n      if (curr.activeElementId === itemId) return;\n      curr.activeElementId = itemId;\n      this.debouncedFindCondition();\n    },\n    // 点击条件时\n    onClickCondition: function onClickCondition(curr, itemName) {\n      if (curr.activeConditionName === itemName) return;\n      curr.activeConditionName = itemName;\n      this.debouncedFindCondition();\n    },\n    // 寻找选中的条件\n    findCondition: function findCondition() {\n      var _this4 = this;\n\n      var currFcst = this.options.find(function (el) {\n        return el.fcstName === _this4.currFcstName;\n      });\n      this.currfcst = currFcst; // console.log(currFcst);\n\n      var id = currFcst.id;\n      this.currFcstOption = currFcst; // 多模式预报\n\n      if (id === \"FenXiDiMian\") {\n        this.img_active = false;\n        var currContent = currFcst.contents.find(function (el) {\n          return el.typeName === currFcst.activeTypeName;\n        });\n        currContent.contents.forEach(function (content) {\n          content.sections.forEach(function (section) {\n            section.items.forEach(function (el) {\n              if (el.id === currContent.activeElementId) {\n                _this4.currEleOption = el;\n                _this4.currTypeOption = currContent;\n                _this4.currEleIdList = content.sections.reduce(function (curr, el) {\n                  return curr.concat(el.items.map(function (el) {\n                    return el.id;\n                  }));\n                }, []); // console.log(this.currEleIdList);\n                // console.log(currContent.typeName);\n                // console.log(currContent.date);\n                // console.log(currContent.hour);\n                // console.log(el.name);\n                // console.log(el);\n                // body处理\n\n                var strTime = '';\n\n                if (currContent.date) {\n                  strTime = currContent.date.format('YYYY-MM-DD') + ' ' + currContent.hour + ':00:00';\n                }\n\n                var forecastTime = '';\n\n                if (strTime) {\n                  forecastTime = moment(strTime, 'YYYY-MM-DD HH:mm:ss').add(+currFcst.aging, 'hours').format('YYYY-MM-DD HH:mm:ss');\n                }\n\n                var eleName = ['OBSanaly', currContent.id, el.name].join(':');\n                var body = {\n                  modeName: 'qiangtianqi',\n                  eleName: eleName,\n                  forecastTime: forecastTime,\n                  level: el.activeLevel,\n                  userDefinedParas: '',\n                  strTime: strTime // 有起报时间 与 无起报时间(即第一次请求)\n\n                };\n\n                if (strTime) {\n                  if (currContent.isStability === true) {\n                    //当稳定性为true\n                    _this4.requestStabilityImgPath(body, currContent);\n                  } else {\n                    _this4.requestImgPath(body);\n                  }\n                } else {\n                  _this4.requestImgPath(body, currContent, currFcst);\n                }\n              }\n            });\n          });\n        });\n      } else if (id === \"FenXiGaokong\") {\n        //集合预报\n        this.img_active = true;\n\n        var _currContent = currFcst.contents.find(function (el) {\n          return el.typeName === currFcst.activeTypeName;\n        });\n\n        _currContent.contents.forEach(function (content) {\n          content.sections.forEach(function (section) {\n            section.items.forEach(function (el) {\n              if (el.id === _currContent.activeElementId) {\n                _this4.currEleOption = el;\n                _this4.currTypeOption = _currContent;\n                _this4.currEleIdList = content.sections.reduce(function (curr, el) {\n                  return curr.concat(el.items.map(function (el) {\n                    return el.id;\n                  }));\n                }, []); // console.log(this.currEleIdList);\n                // console.log(currContent.typeName);\n                // console.log(currContent.date);\n                // console.log(currContent.hour);\n                // console.log(el.name);\n                // console.log(el);\n                // body处理\n\n                var strTime = '';\n\n                if (_currContent.date) {\n                  strTime = _currContent.date.format('YYYY-MM-DD') + ' ' + _currContent.hour + ':00:00';\n                }\n\n                var forecastTime = '';\n\n                if (strTime) {\n                  forecastTime = moment(strTime, 'YYYY-MM-DD HH:mm:ss').add(+currFcst.aging, 'hours').format('YYYY-MM-DD HH:mm:ss');\n                } // console.log(currContent)\n                // console.log(currContent.activeElementId.substr(5))\n\n\n                if (_currContent.activeElementId.substr(5) > 6 && _currContent.activeElementId.substr(5) < 32) {\n                  el.activeLevel = _currContent.glevel;\n\n                  _this4.$set(_currContent, 'gSwitch', false);\n\n                  _this4.$set(_currContent, 'sSwitch', true);\n                } else if (_currContent.activeElementId.substr(5) > 31) {\n                  el.activeLevel = _currContent.slevel;\n\n                  _this4.$set(_currContent, 'gSwitch', true);\n\n                  _this4.$set(_currContent, 'sSwitch', false);\n                } else {\n                  el.activeLevel = '';\n\n                  _this4.$set(_currContent, 'gSwitch', true);\n\n                  _this4.$set(_currContent, 'sSwitch', true);\n                }\n\n                var eleName = ['OBSanaly', _currContent.id, el.name].join(':');\n                var body = {\n                  modeName: 'qiangtianqi',\n                  eleName: eleName,\n                  forecastTime: forecastTime,\n                  level: el.activeLevel,\n                  // level:850,\n                  userDefinedParas: '',\n                  strTime: strTime // 有起报时间 与 无起报时间(即第一次请求)\n\n                };\n\n                if (strTime) {\n                  if (_currContent.isStability === true) {\n                    //当稳定性为true\n                    _this4.requestStabilityImgPath(body, _currContent);\n                  } else {\n                    _this4.requestImgPath(body);\n                  }\n                } else {\n                  _this4.requestImgPath(body, _currContent, currFcst);\n                }\n              }\n            });\n          });\n        });\n      } else if (id === \"FenXiZiDongZhan\") {\n        //概率预报\n        this.img_active = false;\n\n        var _currContent2 = currFcst.contents.find(function (el) {\n          return el.typeName === currFcst.activeTypeName;\n        });\n\n        _currContent2.contents.forEach(function (content) {\n          content.sections.forEach(function (section) {\n            section.items.forEach(function (el) {\n              if (el.id === _currContent2.activeElementId) {\n                _this4.currEleOption = el;\n                _this4.currTypeOption = _currContent2;\n                _this4.currEleIdList = content.sections.reduce(function (curr, el) {\n                  return curr.concat(el.items.map(function (el) {\n                    return el.id;\n                  }));\n                }, []); // console.log(this.currEleIdList);\n                // console.log(currContent.typeName);\n                // console.log(currContent.date);\n                // console.log(currContent.hour);\n                // console.log(el.name);\n                // console.log(el);\n                // body处理\n\n                var strTime = '';\n\n                if (_currContent2.date) {\n                  strTime = _currContent2.date.format('YYYY-MM-DD') + ' ' + _currContent2.hour + ':00:00';\n                }\n\n                var forecastTime = '';\n\n                if (strTime) {\n                  forecastTime = moment(strTime, 'YYYY-MM-DD HH:mm:ss').add(+currFcst.aging, 'hours').format('YYYY-MM-DD HH:mm:ss');\n                }\n\n                var eleName = ['OBSanaly', _currContent2.id, el.name].join(':');\n                var body = {\n                  modeName: 'qiangtianqi',\n                  eleName: eleName,\n                  forecastTime: forecastTime,\n                  level: el.activeLevel,\n                  userDefinedParas: '',\n                  strTime: strTime // 有起报时间 与 无起报时间(即第一次请求)\n\n                };\n\n                if (strTime) {\n                  if (_currContent2.isStability === true) {\n                    //当稳定性为true\n                    _this4.requestStabilityImgPath(body, _currContent2);\n                  } else {\n                    _this4.requestImgPath(body);\n                  }\n                } else {\n                  _this4.requestImgPath(body, _currContent2, currFcst);\n                }\n              }\n            });\n          });\n        });\n      }\n    },\n    // 请求图片路径(只针对稳定性)\n    requestStabilityImgPath: function requestStabilityImgPath(body, citeObj) {\n      var _this5 = this;\n\n      // 取消之前的所有未完成的请求\n      this.cancelAllRequest(); // 存储取消时的token\n\n      var CancelToken = axios.CancelToken; // 请求处理\n\n      var h = citeObj.hourList;\n      var agingInterval = citeObj.hourList.length > 1 ? Math.abs(h[1] - h[0]) : 24;\n      var startTime = moment(body.strTime, 'YYYY-MM-DD HH:mm:ss');\n      var requestList = new Array(4).fill(0).map(function (el, i) {\n        var strTime = startTime.clone().subtract(agingInterval * i, 'hours').format('YYYY-MM-DD HH:mm:ss');\n\n        var currBody = _objectSpread({}, body, {\n          strTime: strTime\n        });\n\n        var params = new URLSearchParams();\n\n        for (var key in currBody) {\n          params.append(key, currBody[key]);\n        }\n\n        return axios.post(\"/proxy/10.20.67.111/PictureInfoForgetFilePath.action\", params, {\n          cancelToken: new CancelToken(function (c) {\n            _this5.cancelRequests.push(c);\n          })\n        });\n      }); // 请求数据\n\n      axios.all(requestList).then(function (datas) {\n        _this5.imgPaths = datas.map(function (data) {\n          if (!data.data.path) return '';\n          var path = data.data.path.split(',').pop();\n\n          if (path) {\n            return 'http://10.20.67.111/getPic.action2?ppath=' + path;\n          }\n\n          return '';\n        });\n      });\n    },\n    // 请求图片路径\n    requestImgPath: function requestImgPath(body, timeCiteObj, agingCiteObj) {\n      var _this6 = this;\n\n      // 取消之前的所有未完成的请求\n      this.cancelAllRequest(); // 存储取消时的token\n\n      var CancelToken = axios.CancelToken; // 参数转换\n\n      var params = new URLSearchParams();\n\n      for (var key in body) {\n        params.append(key, body[key]);\n      } // 请求数据\n\n\n      axios.post(\"/proxy/10.20.67.111/PictureInfoForgetFilePath.action\", params, {\n        cancelToken: new CancelToken(function (c) {\n          _this6.cancelRequests.push(c);\n        })\n      }).then(function (data) {\n        if (!data.data.path) {\n          _this6.imgPaths = [''];\n          return;\n        } // [模式名字 要素名字  发布时间  预报时间 层次  文件路径]\n\n\n        var _data$data$path$split = data.data.path.split(','),\n            _data$data$path$split2 = _slicedToArray(_data$data$path$split, 6),\n            patternName = _data$data$path$split2[0],\n            eleName = _data$data$path$split2[1],\n            startTime = _data$data$path$split2[2],\n            fcstTime = _data$data$path$split2[3],\n            level = _data$data$path$split2[4],\n            filePath = _data$data$path$split2[5]; // 第一次请求数据 && 有文件路径返回时\n\n\n        if (timeCiteObj && filePath) {\n          var startT = moment(startTime, 'YYYY-MM-DD HH:mm:ss');\n          var fcstT = moment(fcstTime, 'YYYY-MM-DD HH:mm:ss');\n          var startStamp = startT.unix();\n          var fcstStamp = fcstT.unix();\n\n          var aging = _this6.formatAging((fcstStamp - startStamp) / 60 / 60);\n\n          agingCiteObj.aging = aging;\n          timeCiteObj.date = startT.clone().startOf('day');\n          timeCiteObj.hour = startT.format('HH');\n          _this6.currEleOption.activeLevel = level;\n        }\n\n        _this6.imgPaths = ['http://10.20.67.111/getPic.action2?ppath=' + filePath];\n      });\n    },\n    // 格式化时效\n    formatAging: function formatAging(val) {\n      val += '';\n      var leng = val.length;\n      if (leng === 1) return '00' + val;\n      if (leng === 2) return '0' + val;\n      return val;\n    },\n    // 取消所有请求\n    cancelAllRequest: function cancelAllRequest() {\n      if (this.cancelRequests.length) {\n        this.cancelRequests.forEach(function (el) {\n          return el();\n        });\n        this.cancelRequests = [];\n      }\n    }\n  })\n};",{"version":3,"sources":["D:\\program\\frontend\\src\\views\\diagnosis\\diagnosis.js"],"names":["moment","axios","_","DateSelect","LevelSelect","AreaSelect","WholeAgingSelect","TimeSelect","AgingSelect","ImgShow","SideBar","Login","ToolBtn","options","createNamespacedHelpers","mapState","mapGetters","mapMutations","name","components","data","dieSwitch","login_switch","img_active","cancelRequests","loginzt","area","activeIndex","currFcstName","currEleOption","currFcstOption","currTypeOption","currEleIdList","user","activeClose","pass","imgPaths","coverPaths","login_data","currDate","zoomSw","currHour","hourList","interval","computed","startTime","isMoment","date","format","hour","currEleIdListLength","length","created","debouncedFindCondition","debounce","findCondition","mounted","beforeDestroy","cancelAllRequest","watch","updata_zoomUrl","methods","preChange","val","contents","slevel","onConditionChange","highChange","glevel","show_zoom","updata_zoomSwitch","close","loginF","i","loginFn","add","alert","select","dieFn","JSON","parse","changDate","time","subtract","changeHour","params","URLSearchParams","key","append","post","then","res","push","path","split","loginResult","document","querySelector","innerHTML","img","Image","src","style","cssText","onload","appendChild","onerror","require","onKeyup","event","code","$refs","wholeAgingSelect","onTuningAging","activeElementId","isProb","find","el","fcstName","currIndex","findIndex","id","nextIndex","nextActiveElementId","onSwitchImg","sign","levelSelect","onTuningLevel","onClickElement","curr","itemId","onClickCondition","itemName","activeConditionName","currFcst","currfcst","currContent","typeName","activeTypeName","forEach","content","sections","section","items","reduce","concat","map","strTime","forecastTime","aging","eleName","join","body","modeName","level","activeLevel","userDefinedParas","isStability","requestStabilityImgPath","requestImgPath","substr","$set","citeObj","CancelToken","h","agingInterval","Math","abs","requestList","Array","fill","clone","currBody","cancelToken","c","all","datas","pop","timeCiteObj","agingCiteObj","patternName","fcstTime","filePath","startT","fcstT","startStamp","unix","fcstStamp","formatAging","startOf","leng"],"mappings":"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","sourcesContent":["import * as moment from \"moment\";\r\nimport * as axios from \"axios\";\r\nimport _ from 'lodash';\r\nimport {\r\n  DateSelect,\r\n  LevelSelect,\r\n  AreaSelect,\r\n  WholeAgingSelect,\r\n  TimeSelect,\r\n  AgingSelect,\r\n  ImgShow,\r\n  SideBar,\r\n  Login\r\n} from \"../../components/share\";\r\nimport { ToolBtn } from '../../components/base';\r\nimport options from \"../../assets/config/diagnosis_config\";\r\nimport { createNamespacedHelpers } from \"vuex\";\r\nconst { mapState, mapGetters, mapMutations } = createNamespacedHelpers(\r\n  \"synthesis\"\r\n)\r\n\r\nexport default {\r\n  name: \"Diagnosis\",\r\n  components: { DateSelect, LevelSelect, AreaSelect, WholeAgingSelect, TimeSelect, AgingSelect, ImgShow, SideBar, Login, ToolBtn },\r\n  data: function () {\r\n    return {\r\n      dieSwitch: false,\r\n      login_switch: false,\r\n      // 该引用存储短期所有配置\r\n      options,\r\n      img_active: false,\r\n      cancelRequests: [],\r\n      loginzt: false,\r\n\r\n      area: \"全国\",\r\n      activeIndex: null,\r\n      // 当前选中的预报类型\r\n      currFcstName: \"地面\",\r\n\r\n      // 该引用当前选中的要素配置\r\n      currEleOption: null,\r\n\r\n      // 该引用当前预报配置\r\n      currFcstOption: null,\r\n\r\n      // 该引用含有当前起报时间以及当前选中要素的id\r\n      currTypeOption: null,\r\n\r\n      // 当前选中路径下的所有要素id的列表\r\n      currEleIdList: [],\r\n\r\n      // 图片地址\r\n      user:'',\r\n      activeClose:false,\r\n      pass:'',\r\n      imgPaths: [],\r\n      coverPaths:[],\r\n      login_data: {},\r\n      currDate: null,\r\n      zoomSw:false,\r\n      currHour: '02',\r\n      hourList: ['02', '05', '08', '11', '14', '17', '20', '23'],\r\n      interval: '24h'\r\n    };\r\n  },\r\n  computed: {\r\n    ...mapState([\"zoomSwitch\",\"zoomUrl\"]),\r\n    // 当前起报时间\r\n    startTime() {\r\n      if (this.currTypeOption && moment.isMoment(this.currTypeOption.date)) {\r\n        return this.currTypeOption.date.format('YYYY-MM-DD') + ' ' + this.currTypeOption.hour;\r\n      }\r\n      return '';\r\n    },\r\n    currEleIdListLength() {\r\n      return this.currEleIdList.length;\r\n    }\r\n  },\r\n  created() {\r\n    this.debouncedFindCondition = _.debounce(this.findCondition, 300);\r\n  },\r\n  mounted() {\r\n    this.findCondition();\r\n  },\r\n\r\n  beforeDestroy() {\r\n    this.cancelAllRequest();\r\n  },\r\n  watch:{\r\n    imgPaths(){\r\n      this.updata_zoomUrl(this.imgPaths[0])\r\n    }\r\n  },\r\n  methods: {\r\n    moment,\r\n    preChange(val){\r\n      options[1].contents[0].slevel=val\r\n      this.onConditionChange()\r\n    },\r\n    highChange(val){\r\n      options[1].contents[0].glevel=val\r\n      this.onConditionChange()\r\n    },\r\n    ...mapMutations([\"updata_zoomSwitch\",\"updata_zoomUrl\"]),\r\n    show_zoom(){\r\n      this.updata_zoomSwitch(true)\r\n      this.updata_zoomUrl(this.imgPaths[0])\r\n    },\r\n    // ...mapMutations([\r\n    //   \"updata_zoomSwitch\",\r\n    // ]),\r\n    close(){\r\n      this.updata_zoomSwitch(false)\r\n    },\r\n    loginF(i){\r\n      // console.log(i)\r\n      if(i){\r\n        if(this.user=='swpc'&&this.pass=='swpc'){\r\n          this.loginFn(this.interval, moment(this.currDate).add(this.currHour,'hour').format('YYYY-MM-DD HH:mm:ss'))\r\n          this.login_switch=false\r\n        }else{\r\n          alert('用户名或密码错误')\r\n        }\r\n      }else{\r\n        this.login_switch=false\r\n        this.activeIndex=null\r\n      }\r\n    },\r\n    select(i) {\r\n      this.activeClose=!this.activeClose\r\n      if (this.activeIndex == i) {\r\n        if(!this.activeClose){\r\n          this.activeIndex = null\r\n          this.dieSwitch=false\r\n          this.dieFn()\r\n          // alert(options[0].contents[0].hour)\r\n          this.currHour=options[0].contents[0].hour\r\n          this.loginzt=false\r\n          this.activeClose=false\r\n        }\r\n      } else {\r\n        // let value=JSON.parse(JSON.stringify(options[0].contents[0].date))\r\n        this.currHour=options[0].contents[0].hour\r\n        this.currDate = moment(JSON.parse(JSON.stringify(options[0].contents[0].date)))\r\n        if (i === 1) {\r\n          this.loginzt=true\r\n          this.dieFn(this.interval, moment(this.currDate).add(this.currHour,'hour').format('YYYY-MM-DD HH:mm:ss'))\r\n        } else {\r\n          this.login_switch=true\r\n          this.loginzt=false\r\n        }\r\n        this.activeIndex = i\r\n      }\r\n    },\r\n    changDate(i) {\r\n      const time = moment(this.currDate.format('YYYYMMDD 00:00:00'), 'YYYYMMDD HH:mm:ss').add(this.currHour, 'hours');\r\n      // console.log( time)\r\n      if (i === 1) {\r\n        time.add(parseInt(this.loginzt?this.interval:1), 'hours');\r\n      } else {\r\n        time.subtract(parseInt(this.loginzt?this.interval:1), 'hours');\r\n      }\r\n      this.currDate = time;\r\n      this.currHour = time.format('HH');\r\n      if (this.activeIndex == 2) {\r\n        this.loginFn(this.interval, moment(this.currDate).format('YYYY-MM-DD HH:mm:ss'))\r\n      } else if (this.activeIndex == 1) {\r\n        this.dieFn(this.interval, moment(this.currDate).format('YYYY-MM-DD HH:mm:ss'))\r\n      }\r\n      // this.$emit('dieFn',this.interval,moment(this.currDate).format('YYYY-MM-DD HH:mm:ss'))\r\n    },\r\n    changeHour() {\r\n      if(this.activeIndex==1){\r\n      // console.log(moment(this.currDate).format('YYYY-MM-DD HH:mm:ss'))\r\n        this.dieFn(this.interval, moment(this.currDate).format('YYYY-MM-DD HH:mm:ss'))\r\n      }else{\r\n        this.loginFn(this.interval, moment(this.currDate).add(this.currHour,'hour').format('YYYY-MM-DD HH:mm:ss'))\r\n      }\r\n      \r\n    },\r\n    dieFn(interval, date) {\r\n      // document.querySelector('.imgDie').innerHTML = ''\r\n      this.coverPaths=[]\r\n      // console.log(interval, date)\r\n      if (interval && date) {\r\n        this.dieSwitch = true\r\n        let data = {\r\n          'modeName': 'qiangtianqi',\r\n          'eleName': `OBSoverlay:实况叠加:${interval}`,\r\n          'forecastTime': date,\r\n          'level': '',\r\n          'userDefinedParas': '',\r\n          'strTime': date,\r\n          'symbol': 1\r\n        }\r\n        const params = new URLSearchParams();\r\n        for (const key in data) {\r\n          params.append(key, data[key]);\r\n        }\r\n        axios.post(`/proxy/10.20.67.111/PictureInfoForgetFilePath.action`, params).then(res => {\r\n          this.coverPaths.push(`http://10.20.67.111/getPic.action2?ppath=${res.data.path.split(',')[5]}`)\r\n          // console.log(res.data.path.split(','))\r\n          // let img = new Image()\r\n          // img.src = `http://10.20.67.111/getPic.action2?ppath=${res.data.path.split(',')[5]}`\r\n          // img.style.cssText = 'width:100%;height:100%;'\r\n          // // this.dieImgSrc=`http://10.20.67.111/getPic.action2?ppath=\\\\${res.data.path.split(',')[5]}`\r\n          // img.onload = () => {\r\n          //   document.querySelector('.imgDie').appendChild(img)\r\n          // }\r\n          // img.onerror = () => {\r\n          //   img.src = require('../../assets/images/404.png')\r\n          //   document.querySelector('.imgDie').appendChild(img)\r\n          // }\r\n        })\r\n      } else {\r\n        // alert\r\n        this.coverPaths=[]\r\n      }\r\n\r\n    },\r\n    loginFn(interval, date) {\r\n      // if (this.loginzt) {\r\n        this.coverPaths=[]\r\n        // document.querySelector('.imgDie').innerHTML = ''\r\n        // console.log(interval, date)\r\n        if (interval && date) {\r\n          this.dieSwitch = true\r\n          let data = {\r\n            'modeName': 'qiangtianqi',\r\n            'eleName': `forecastoverlay:预报`,\r\n            'forecastTime': moment(date,'YYYY-MM-DD HH:mm:ss').add(parseInt(this.interval),'hour').format('YYYY-MM-DD HH:mm:ss'),\r\n            'level': '',\r\n            'userDefinedParas': '',\r\n            'strTime': date,\r\n            'symbol':2\r\n          }\r\n          const params = new URLSearchParams();\r\n          for (const key in data) {\r\n            params.append(key, data[key]);\r\n          }\r\n          axios.post(`/proxy/10.20.67.111/PictureInfoForgetFilePath.action`, params).then(res => {\r\n          this.coverPaths.push(`http://10.20.67.111/getPic.action2?ppath=${res.data.path.split(',')[5]}`)\r\n\r\n            // console.log(res.data.path.split(','))\r\n            // let img = new Image()\r\n            // img.src = `http://10.20.67.111/getPic.action2?ppath=${res.data.path.split(',')[5]}`\r\n            // img.style.cssText = 'width:100%;height:100%;'\r\n            // // this.dieImgSrc=`http://10.20.67.111/getPic.action2?ppath=\\\\${res.data.path.split(',')[5]}`\r\n            // img.onload = () => {\r\n            //   document.querySelector('.imgDie').appendChild(img)\r\n            // }\r\n            // img.onerror = () => {\r\n            //   img.src = require('../../assets/images/404.png')\r\n            //   document.querySelector('.imgDie').appendChild(img)\r\n            // }\r\n          })\r\n        }\r\n      // } else {\r\n      //   if (interval && date) {\r\n      //     this.login_data = {\r\n      //       interval, date\r\n      //     }\r\n      //     this.login_switch = true\r\n      //   } else {\r\n      //     this.dieSwitch = false\r\n      //     this.login_switch = false\r\n      //   }\r\n      // }\r\n\r\n    },\r\n    loginResult(val) {\r\n      this.loginzt = val\r\n      this.login_switch = false\r\n      if (val) {\r\n        document.querySelector('.imgDie').innerHTML = ''\r\n        // console.log(interval, date)\r\n        if (this.login_data.interval && this.login_data.date) {\r\n          this.dieSwitch = true\r\n          let data = {\r\n            'modeName': 'qiangtianqi',\r\n            'eleName': `forecastoverlay:预报`,\r\n            'forecastTime': this.login_data.date,\r\n            'level': '',\r\n            'userDefinedParas': '',\r\n            'strTime': this.login_data.date,\r\n            'symbol': 1\r\n          }\r\n          const params = new URLSearchParams();\r\n          for (const key in data) {\r\n            params.append(key, data[key]);\r\n          }\r\n          axios.post(`/proxy/10.20.67.111/PictureInfoForgetFilePath.action`, params).then(res => {\r\n            // console.log(res.data.path.split(','))\r\n            let img = new Image()\r\n            img.src = `http://10.20.67.111/getPic.action2?ppath=${res.data.path.split(',')[5]}`\r\n            img.style.cssText = 'width:100%;height:100%;'\r\n            // this.dieImgSrc=`http://10.20.67.111/getPic.action2?ppath=\\\\${res.data.path.split(',')[5]}`\r\n            img.onload = () => {\r\n              document.querySelector('.imgDie').appendChild(img)\r\n            }\r\n            img.onerror = () => {\r\n              img.src = require('../../assets/images/404.png')\r\n              document.querySelector('.imgDie').appendChild(img)\r\n            }\r\n          })\r\n        }\r\n      }\r\n    },\r\n    // 键盘事件监听\r\n    onKeyup(event) {\r\n      const { code } = event;\r\n      if (code === 'ArrowLeft') {\r\n        this.$refs.wholeAgingSelect[0].onTuningAging(-1);\r\n      } else if (code === 'ArrowRight') {\r\n        this.$refs.wholeAgingSelect[0].onTuningAging(1);\r\n      } else if (code === 'ArrowUp' || code === 'ArrowDown') {\r\n\r\n        let activeElementId = '';\r\n        const isProb = this.currFcstName === '概率预报';\r\n        if (isProb) {\r\n          activeElementId = this.options.find(el => el.fcstName === this.currFcstName).activeElementId;\r\n        } else {\r\n          activeElementId = this.currTypeOption.activeElementId;\r\n        }\r\n        const currIndex = this.currEleIdList.findIndex(id => id === activeElementId);\r\n        if (currIndex === -1) return;\r\n        let nextIndex = currIndex + (code === 'ArrowUp' ? -1 : 1);\r\n        if (nextIndex <= 0) {\r\n          nextIndex = this.currEleIdListLength - 1;\r\n        } else if (nextIndex >= this.currEleIdListLength) {\r\n          nextIndex = 0;\r\n        }\r\n\r\n        const nextActiveElementId = this.currEleIdList[nextIndex];\r\n        if (isProb) {\r\n          this.options.find(el => el.fcstName === this.currFcstName).activeElementId = nextActiveElementId;\r\n        } else {\r\n          this.currTypeOption.activeElementId = nextActiveElementId;\r\n        }\r\n\r\n        this.debouncedFindCondition();\r\n      }\r\n    },\r\n\r\n    // 图片切换事件\r\n    onSwitchImg(sign) {\r\n      if (sign === 'left') {\r\n        this.$refs.wholeAgingSelect[0].onTuningAging(-1);\r\n      } else if (sign === 'right') {\r\n        this.$refs.wholeAgingSelect[0].onTuningAging(1);\r\n      } else if (sign === 'top') {\r\n        this.$refs.levelSelect.onTuningLevel(1);\r\n      } else if (sign === 'bottom') {\r\n        this.$refs.levelSelect.onTuningLevel(-1);\r\n      }\r\n    },\r\n\r\n    // 条件改变时\r\n    onConditionChange() {\r\n      this.debouncedFindCondition();\r\n    },\r\n\r\n    //点击要素时\r\n    onClickElement(curr, itemId) {\r\n      if (curr.activeElementId === itemId) return;\r\n      curr.activeElementId = itemId;\r\n      this.debouncedFindCondition();\r\n    },\r\n\r\n    // 点击条件时\r\n    onClickCondition(curr, itemName) {\r\n      if (curr.activeConditionName === itemName) return;\r\n      curr.activeConditionName = itemName;\r\n      this.debouncedFindCondition();\r\n    },\r\n\r\n    // 寻找选中的条件\r\n    findCondition() {\r\n      const currFcst = this.options.find(\r\n        el => el.fcstName === this.currFcstName\r\n      );\r\n      this.currfcst = currFcst;\r\n      // console.log(currFcst);\r\n      const id = currFcst.id;\r\n\r\n      this.currFcstOption = currFcst;\r\n\r\n      // 多模式预报\r\n      if (id === \"FenXiDiMian\") {\r\n        this.img_active = false\r\n        const currContent = currFcst.contents.find(\r\n          el => el.typeName === currFcst.activeTypeName\r\n        );\r\n        currContent.contents.forEach(content => {\r\n          content.sections.forEach(section => {\r\n            section.items.forEach(el => {\r\n              if (el.id === currContent.activeElementId) {\r\n                this.currEleOption = el;\r\n                this.currTypeOption = currContent;\r\n                this.currEleIdList = content.sections.reduce((curr, el) => {\r\n                  return curr.concat(el.items.map(el => el.id));\r\n                }, []);\r\n                // console.log(this.currEleIdList);\r\n                // console.log(currContent.typeName);\r\n                // console.log(currContent.date);\r\n                // console.log(currContent.hour);\r\n                // console.log(el.name);\r\n                // console.log(el);\r\n\r\n                // body处理\r\n                let strTime = '';\r\n                if (currContent.date) {\r\n                  strTime = currContent.date.format('YYYY-MM-DD') + ' ' + currContent.hour + ':00:00';\r\n                }\r\n                let forecastTime = '';\r\n                if (strTime) {\r\n                  forecastTime = moment(strTime, 'YYYY-MM-DD HH:mm:ss').add(+currFcst.aging, 'hours').format('YYYY-MM-DD HH:mm:ss');\r\n                }\r\n                const eleName = ['OBSanaly', currContent.id, el.name].join(':');\r\n                const body = {\r\n                  modeName: 'qiangtianqi',\r\n                  eleName,\r\n                  forecastTime,\r\n                  level: el.activeLevel,\r\n                  userDefinedParas: '',\r\n                  strTime\r\n                }\r\n                // 有起报时间 与 无起报时间(即第一次请求)\r\n                if (strTime) {\r\n                  if (currContent.isStability === true) {  //当稳定性为true\r\n                    this.requestStabilityImgPath(body, currContent);\r\n                  } else {\r\n                    this.requestImgPath(body);\r\n                  }\r\n                } else {\r\n                  this.requestImgPath(body, currContent, currFcst);\r\n                }\r\n\r\n              }\r\n            });\r\n          });\r\n        });\r\n      } else if (id === \"FenXiGaokong\") {  //集合预报\r\n        this.img_active = true\r\n        const currContent = currFcst.contents.find(\r\n          el => el.typeName === currFcst.activeTypeName\r\n        );\r\n        currContent.contents.forEach(content => {\r\n          content.sections.forEach(section => {\r\n            section.items.forEach(el => {\r\n              if (el.id === currContent.activeElementId) {\r\n                this.currEleOption = el;\r\n                this.currTypeOption = currContent;\r\n                this.currEleIdList = content.sections.reduce((curr, el) => {\r\n                  return curr.concat(el.items.map(el => el.id));\r\n                }, []);\r\n                // console.log(this.currEleIdList);\r\n                // console.log(currContent.typeName);\r\n                // console.log(currContent.date);\r\n                // console.log(currContent.hour);\r\n                // console.log(el.name);\r\n                // console.log(el);\r\n\r\n                // body处理\r\n                let strTime = '';\r\n                if (currContent.date) {\r\n                  strTime = currContent.date.format('YYYY-MM-DD') + ' ' + currContent.hour + ':00:00';\r\n                }\r\n                let forecastTime = '';\r\n                if (strTime) {\r\n                  forecastTime = moment(strTime, 'YYYY-MM-DD HH:mm:ss').add(+currFcst.aging, 'hours').format('YYYY-MM-DD HH:mm:ss');\r\n                }\r\n                // console.log(currContent)\r\n                // console.log(currContent.activeElementId.substr(5))\r\n                if (currContent.activeElementId.substr(5) > 6 && currContent.activeElementId.substr(5) < 32) {\r\n                  el.activeLevel = currContent.glevel\r\n                  this.$set(currContent, 'gSwitch', false)\r\n                  this.$set(currContent, 'sSwitch', true)\r\n                } else if (currContent.activeElementId.substr(5) > 31) {\r\n                  el.activeLevel = currContent.slevel\r\n                  this.$set(currContent, 'gSwitch', true)\r\n                  this.$set(currContent, 'sSwitch', false)\r\n                } else {\r\n                  el.activeLevel = ''\r\n                  this.$set(currContent, 'gSwitch', true)\r\n                  this.$set(currContent, 'sSwitch', true)\r\n                }\r\n                const eleName = ['OBSanaly', currContent.id, el.name].join(':');\r\n                const body = {\r\n                  modeName: 'qiangtianqi',\r\n                  eleName,\r\n                  forecastTime,\r\n                  level: el.activeLevel,\r\n                  // level:850,\r\n                  userDefinedParas: '',\r\n                  strTime\r\n                }\r\n                // 有起报时间 与 无起报时间(即第一次请求)\r\n                if (strTime) {\r\n                  if (currContent.isStability === true) {  //当稳定性为true\r\n                    this.requestStabilityImgPath(body, currContent);\r\n                  } else {\r\n                    this.requestImgPath(body);\r\n                  }\r\n                } else {\r\n                  this.requestImgPath(body, currContent, currFcst);\r\n                }\r\n\r\n              }\r\n            });\r\n          });\r\n        });\r\n      } else if (id === \"FenXiZiDongZhan\") {  //概率预报\r\n        this.img_active = false\r\n        const currContent = currFcst.contents.find(\r\n          el => el.typeName === currFcst.activeTypeName\r\n        );\r\n        currContent.contents.forEach(content => {\r\n          content.sections.forEach(section => {\r\n            section.items.forEach(el => {\r\n              if (el.id === currContent.activeElementId) {\r\n                this.currEleOption = el;\r\n                this.currTypeOption = currContent;\r\n                this.currEleIdList = content.sections.reduce((curr, el) => {\r\n                  return curr.concat(el.items.map(el => el.id));\r\n                }, []);\r\n                // console.log(this.currEleIdList);\r\n                // console.log(currContent.typeName);\r\n                // console.log(currContent.date);\r\n                // console.log(currContent.hour);\r\n                // console.log(el.name);\r\n                // console.log(el);\r\n\r\n                // body处理\r\n                let strTime = '';\r\n                if (currContent.date) {\r\n                  strTime = currContent.date.format('YYYY-MM-DD') + ' ' + currContent.hour + ':00:00';\r\n                }\r\n                let forecastTime = '';\r\n                if (strTime) {\r\n                  forecastTime = moment(strTime, 'YYYY-MM-DD HH:mm:ss').add(+currFcst.aging, 'hours').format('YYYY-MM-DD HH:mm:ss');\r\n                }\r\n                const eleName = ['OBSanaly', currContent.id, el.name].join(':');\r\n                const body = {\r\n                  modeName: 'qiangtianqi',\r\n                  eleName,\r\n                  forecastTime,\r\n                  level: el.activeLevel,\r\n                  userDefinedParas: '',\r\n                  strTime\r\n                }\r\n                // 有起报时间 与 无起报时间(即第一次请求)\r\n                if (strTime) {\r\n                  if (currContent.isStability === true) {  //当稳定性为true\r\n                    this.requestStabilityImgPath(body, currContent);\r\n                  } else {\r\n                    this.requestImgPath(body);\r\n                  }\r\n                } else {\r\n                  this.requestImgPath(body, currContent, currFcst);\r\n                }\r\n\r\n              }\r\n            });\r\n          });\r\n        });\r\n\r\n      }\r\n\r\n    },\r\n\r\n    // 请求图片路径(只针对稳定性)\r\n    requestStabilityImgPath(body, citeObj) {\r\n\r\n      // 取消之前的所有未完成的请求\r\n      this.cancelAllRequest();\r\n\r\n      // 存储取消时的token\r\n      const CancelToken = axios.CancelToken;\r\n\r\n      // 请求处理\r\n      const h = citeObj.hourList;\r\n      const agingInterval = citeObj.hourList.length > 1 ? Math.abs(h[1] - h[0]) : 24;\r\n      const startTime = moment(body.strTime, 'YYYY-MM-DD HH:mm:ss');\r\n      const requestList = new Array(4).fill(0).map((el, i) => {\r\n        const strTime = startTime.clone().subtract(agingInterval * i, 'hours').format('YYYY-MM-DD HH:mm:ss');\r\n        const currBody = { ...body, strTime };\r\n        const params = new URLSearchParams();\r\n        for (const key in currBody) {\r\n          params.append(key, currBody[key]);\r\n        }\r\n        return axios.post(\"/proxy/10.20.67.111/PictureInfoForgetFilePath.action\", params, {\r\n          cancelToken: new CancelToken(c => {\r\n            this.cancelRequests.push(c);\r\n          })\r\n        });\r\n      });\r\n\r\n      // 请求数据\r\n      axios.all(requestList).then(datas => {\r\n        this.imgPaths = datas.map(data => {\r\n          if (!data.data.path) return '';\r\n          const path = data.data.path.split(',').pop();\r\n          if (path) {\r\n            return 'http://10.20.67.111/getPic.action2?ppath=' + path;\r\n          }\r\n          return '';\r\n        });\r\n      })\r\n\r\n    },\r\n\r\n\r\n    // 请求图片路径\r\n    requestImgPath(body, timeCiteObj, agingCiteObj) {\r\n\r\n      // 取消之前的所有未完成的请求\r\n      this.cancelAllRequest();\r\n\r\n      // 存储取消时的token\r\n      const CancelToken = axios.CancelToken;\r\n\r\n      // 参数转换\r\n      const params = new URLSearchParams();\r\n      for (const key in body) {\r\n        params.append(key, body[key]);\r\n      }\r\n\r\n      // 请求数据\r\n      axios.post(\"/proxy/10.20.67.111/PictureInfoForgetFilePath.action\", params, {\r\n        cancelToken: new CancelToken(c => {\r\n          this.cancelRequests.push(c);\r\n        })\r\n      }).then(data => {\r\n\r\n        if (!data.data.path) {\r\n          this.imgPaths = [''];\r\n          return;\r\n        }\r\n\r\n        // [模式名字 要素名字  发布时间  预报时间 层次  文件路径]\r\n        const [patternName, eleName, startTime, fcstTime, level, filePath] = data.data.path.split(',');\r\n\r\n        // 第一次请求数据 && 有文件路径返回时\r\n        if (timeCiteObj && filePath) {\r\n          const startT = moment(startTime, 'YYYY-MM-DD HH:mm:ss');\r\n          const fcstT = moment(fcstTime, 'YYYY-MM-DD HH:mm:ss');\r\n          const startStamp = startT.unix();\r\n          const fcstStamp = fcstT.unix();\r\n          const aging = this.formatAging((fcstStamp - startStamp) / 60 / 60);\r\n          agingCiteObj.aging = aging;\r\n          timeCiteObj.date = startT.clone().startOf('day');\r\n          timeCiteObj.hour = startT.format('HH');\r\n          this.currEleOption.activeLevel = level;\r\n        }\r\n        this.imgPaths = ['http://10.20.67.111/getPic.action2?ppath=' + filePath];\r\n      })\r\n    },\r\n\r\n    // 格式化时效\r\n    formatAging(val) {\r\n      val += '';\r\n      const leng = val.length;\r\n      if (leng === 1) return '00' + val;\r\n      if (leng === 2) return '0' + val;\r\n      return val;\r\n    },\r\n\r\n    // 取消所有请求\r\n    cancelAllRequest() {\r\n      if (this.cancelRequests.length) {\r\n        this.cancelRequests.forEach(el => el());\r\n        this.cancelRequests = [];\r\n      }\r\n    },\r\n  }\r\n\r\n\r\n};\r\n"]}]}